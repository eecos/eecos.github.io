{"meta":{"title":"lijiatingâ€™s Blog","subtitle":"å‡¡æ˜¯æŒ£æ‰è¿‡æ¥çš„äººéƒ½æ˜¯çœŸé‡‘ä¸æ€•ç«ç‚¼çš„ï¼›ä»»ä½•å¹»ç­éƒ½ä¸èƒ½åŠ¨æ‘‡ä»–ä»¬çš„ä¿¡ä»°ï¼šå› ä¸ºä»–ä»¬ä¸€å¼€å§‹å°±çŸ¥é“ä¿¡ä»°ä¹‹è·¯å’Œå¹¸ç¦ä¹‹è·¯å…¨ç„¶ä¸åŒï¼Œè€Œä»–ä»¬æ˜¯ä¸èƒ½é€‰é€‰æ‹©çš„ï¼Œåªæœ‰å¾€è¿™æ¡è·¯èµ°ï¼Œåˆ«çš„éƒ½æ˜¯æ­»è·¯ã€‚è¿™æ ·çš„è‡ªä¿¡ä¸æ˜¯ä¸€æœä¸€å¤•æ‰€èƒ½å…»æˆçš„ã€‚ä½ ç»ä¸èƒ½ä»¥æ­¤æœŸå¾…é‚£äº›åäº”å²å·¦å³çš„å­©å­ã€‚åœ¨å¾—åˆ°è¿™ä¸ªä¿¡å¿µä¹‹ä¹‹å‰ï¼Œå…ˆå¾—å—å°½æ‚²ç—›ï¼Œæµå°½çœ¼æ³ªã€‚å¯æ˜¯è¿™æ ·æ˜¯å¥½çš„ï¼Œåº”è¯¥è¦è¿™æ ·â€¦â€¦","description":"lijiatingâ€™s Blog","author":"æåŠ å»·","url":"https://mrjerryli.github.io"},"pages":[{"title":"about","date":"2018-10-30T02:34:36.000Z","updated":"2019-08-11T01:39:47.196Z","comments":true,"path":"about/index.html","permalink":"https://mrjerryli.github.io/about/index.html","excerpt":"","text":""},{"title":"categories","date":"2018-10-30T02:33:58.000Z","updated":"2019-08-11T03:37:23.154Z","comments":true,"path":"categories/index.html","permalink":"https://mrjerryli.github.io/categories/index.html","excerpt":"","text":""},{"title":"photo","date":"2018-10-30T02:33:58.000Z","updated":"2019-08-11T01:39:47.244Z","comments":true,"path":"photo/index.html","permalink":"https://mrjerryli.github.io/photo/index.html","excerpt":"","text":""},{"title":"tags","date":"2018-10-30T02:33:58.000Z","updated":"2019-08-11T01:39:47.244Z","comments":true,"path":"tags/index.html","permalink":"https://mrjerryli.github.io/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"dockerå‘½ä»¤","slug":"dockerå‘½ä»¤","date":"2020-06-06T16:09:27.000Z","updated":"2020-06-07T17:24:00.185Z","comments":true,"path":"post/a9214619.html","link":"","permalink":"https://mrjerryli.github.io/post/a9214619.html","excerpt":"","text":"docker å›¾æ–‡ä»‹ç» docker docker1 docker2 docker3 Dockerå‘½ä»¤å‚è€ƒèµ„æ–™ Dockeræ–‡æ¡£ https://docs.docker.com å‘½ä»¤æ ¼å¼ 1docker &lt;é€‰é¡¹&gt;&lt;å‘½ä»¤&gt;&lt;å‚æ•°&gt; é€‰é¡¹è¯´æ˜ [] è¡¨ç¤ºè®¾ç½®é€‰é¡¹æ—¶å¯ä»¥è®¾ç½®ä¸åŒçš„å€¼ï¼Œå¹¶ä¸”å¯ä»¥å¤šæ¬¡ä½¿ç”¨ã€‚ =falseè¡¨ç¤ºé»˜è®¤å€¼ä¸ºfalse =&quot;&quot;è¡¨ç¤ºé»˜è®¤æ˜¯ä¸ºç©º å¸®åŠ©æ–‡æ¡£ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677$ docker --help ç”¨æ³•: docker COMMAND A self-sufficient runtime for containers é€‰é¡¹: --config string Location of client config files (default \"C:\\\\Users\\\\junchow\\\\.docker\") -D, --debug å¼€å¯debugæ¨¡å¼ -H, --host list Daemon socket(s) to connect to -l, --log-level string è®¾ç½®æ—¥å¿—çº§åˆ«ï¼Œçº§åˆ«åˆ†ä¸ºdebug|info|warn|error|fatalï¼Œé»˜è®¤ä¸ºinfoã€‚ --tls Use TLS; implied by --tlsverify --tlscacert string Trust certs signed only by this CA (default \"C:\\\\Users\\\\junchow\\\\.docker\\\\machine\\\\machines\\\\default\\\\ca.pem\") --tlscert string Path to TLS certificate file (default \"C:\\\\Users\\\\junchow\\\\.docker\\\\machine\\\\machines\\\\default\\\\cert.pem\") --tlskey string Path to TLS key file (default \"C:\\\\Users\\\\junchow\\\\.docker\\\\machine\\\\machines\\\\default\\\\key.pem\") --tlsverify Use TLS and verify the remote (default true) -v, --version ç»ˆç«¯æ‰“å°æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯å¹¶é€€å‡º ç®¡ç†å‘½ä»¤: config ç®¡ç†Dockeré…ç½® container ç®¡ç†å®¹å™¨ image ç®¡ç†é•œåƒ network ç®¡ç†ç½‘ç»œ node ç®¡ç†SwarmèŠ‚ç‚¹ plugin ç®¡ç†æ’ä»¶ secret ç®¡ç†Dockerå®‰å…¨ service ç®¡ç†æœåŠ¡ swarm ç®¡ç†Swarmé›†ç¾¤ system ç®¡ç†Dockerç³»ç»Ÿ trust Manage trust on Docker images volume ç®¡ç†å· å‘½ä»¤: attach å°†æ ‡å‡†è¾“å…¥å’Œæ ‡å‡†è¾“å‡ºè¿æ¥åˆ°æ­£åœ¨è¿è¡Œçš„å®¹å™¨ build ä½¿ç”¨dockerfileæ–‡ä»¶åˆ›å»ºé•œåƒ commit ä»å®¹å™¨çš„ä¿®æ”¹é¡¹ä¸­åˆ›å»ºæ–°çš„é•œåƒ cp å°†å®¹å™¨çš„ç›®å½•æˆ–æ–‡ä»¶å¤åˆ¶åˆ°æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿä¸­ create åˆ›å»ºä¸€ä¸ªæ–°çš„é•œåƒ diff æ£€æŸ¥å®¹å™¨æ–‡ä»¶ç³»ç»Ÿçš„ä¿®æ”¹ events å®æ—¶è¾“å‡ºdockeræœåŠ¡å™¨ä¸­å‘ç”Ÿçš„äº‹ä»¶ exec ä»å¤–éƒ¨è¿è¡Œå®¹å™¨å†…éƒ¨çš„å‘½ä»¤ export å°†å®¹å™¨çš„æ–‡ä»¶ç³»ç»Ÿåˆ°å¤„ä¸ºtatæ–‡ä»¶åŒ… history æ˜¾ç¤ºé•œåƒçš„å†å² images è¾“å‡ºé•œåƒåˆ—è¡¨ import ä»å‹ç¼©ä¸ºtaræ–‡ä»¶çš„æ–‡ä»¶ç³»ç»Ÿä¸­åˆ›å»ºé•œåƒ info æ˜¾ç¤ºå½“å‰ç³»ç»Ÿä¿¡æ¯ã€dockerå®¹å™¨ä¸é•œåƒä¸ªæ•°ã€è®¾ç½®ä¿¡æ¯ç­‰ inspect ä½¿ç”¨JSONæ ¼å¼æ˜¾ç¤ºå®¹å™¨ä¸é•œåƒçš„è¯¦ç»†ä¿¡æ¯ kill å‘å®¹å™¨å‘é€killä¿¡å·å…³é—­å®¹å™¨ load ä»taræ–‡ä»¶æˆ–æ ‡å‡†è¾“å…¥ä¸­åŠ è½½é•œåƒ login ç™»å½•dockeræ³¨å†ŒæœåŠ¡å™¨ logout é€€å‡ºdockeræ³¨å†ŒæœåŠ¡å™¨ logs è¾“å‡ºå®¹å™¨æ—¥å¿—ä¿¡æ¯ pause æš‚åœå®¹å™¨ä¸­æ­£åœ¨è¿è¡Œçš„æ‰€æœ‰è¿›ç¨‹ port æŸ¥çœ‹å®¹å™¨çš„ç«¯å£æ˜¯å¦å¤„äºå¼€æ”¾çŠ¶æ€ ps è¾“å‡ºå®¹å™¨åˆ—è¡¨ pull ä»æ³¨å†ŒæœåŠ¡å™¨ä¸­æ‹‰å–ä¸€ä¸ªé•œåƒæˆ–ä»“åº“ push å°†é•œåƒæ¨é€åˆ°dockeræ³¨å†ŒæœåŠ¡å™¨ rename é‡å‘½åä¸€ä¸ªå®¹å™¨ restart é‡å¯ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ rm åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ï¼Œè‹¥æ²¡æœ‰æŒ‡å®šæ ‡ç­¾åˆ™åˆ é™¤lastestæ ‡ç­¾ã€‚ rmi åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªé•œåƒï¼Œè‹¥æ²¡æœ‰æŒ‡å®šæ ‡ç­¾åˆ™åˆ é™¤lastestæ ‡ç­¾ã€‚ run åœ¨ä¸€ä¸ªæ–°å®¹å™¨ä¸­ä¸­è¿è¡Œå‘½ä»¤ï¼Œç”¨äºæŒ‡å®šé•œåƒåˆ›å»ºå®¹å™¨ã€‚ save å°†ä¸€ä¸ªæˆ–å¤šä¸ªé•œåƒä¿å­˜ä¸ºtaråŒ… search ä»Docker Hubä¸­æœç´¢é•œåƒ start å¯åŠ¨ä¸€ä¸ªæˆ–å¤šä¸ªå·²ç»åœæ­¢çš„å®¹å™¨ stats Display a live stream of container(s) resource usage statistics stop åœæ­¢ä¸€ä¸ªæˆ–å¤šä¸ªæ­£åœ¨è¿è¡Œçš„å®¹å™¨ tag è®¾ç½®é•œåƒæ ‡ç­¾ top æ˜¾ç¤ºå®¹å™¨ä¸­æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ä¿¡æ¯ unpause é‡å¯pauseå‘½ä»¤æš‚åœçš„å®¹å™¨ update æ›´æ–°ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨çš„é…ç½® version æ˜¾ç¤ºdockerç‰ˆæœ¬ä¿¡æ¯ wait ç­‰å¾…å®¹å™¨ç»ˆæ­¢ç„¶åè¾“å‡ºé€€å‡ºç  Run 'docker COMMAND --help' for more information on a command. å®¹å™¨ç”Ÿå‘½å‘¨æœŸdocker run123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960# runç”¨äºæŒ‡å®šé•œåƒåˆ›å»ºå®¹å™¨$ docker run [é€‰é¡¹] &lt;é•œåƒåç§°, id&gt; [å‘½ä»¤] [å‚æ•°]# é€‰é¡¹-d, --detach=false æŒ‡å®šå®¹å™¨è¿è¡Œäºå‰å°è¿˜æ˜¯åå°ï¼Œé»˜è®¤ä¸ºfalseã€‚-i, --interactive=false æ‰“å¼€æ ‡å‡†è¾“å…¥ç”¨äºæ§åˆ¶å°äº¤äº’-t, --tty=false åˆ†é…ttyè®¾å¤‡ç”¨æ¥æ”¯æŒç»ˆç«¯ç™»å½•ï¼Œé»˜è®¤ä¸ºfalseã€‚-u, --user=\"\" æŒ‡å®šå®¹å™¨çš„ç”¨æˆ·-a, --attach=[] ç™»å½•å®¹å™¨ï¼Œå¿…é¡»æ˜¯ä»¥docker run -då¯åŠ¨çš„å®¹å™¨ã€‚-w, --workdir=\"\" è®¾ç½®å®¹å™¨çš„å·¥ä½œç›®å½•-c, --cpu-shares=0 è®¾ç½®å®¹å™¨CPUæƒé‡ï¼Œåœ¨CPUå…±äº«åœºæ™¯ä¸‹ä½¿ç”¨ã€‚-e, --env=[] è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œå®¹å™¨ä¸­å¯ä½¿ç”¨è¯¥ç¯å¢ƒå˜é‡ã€‚-m, --memory=\"\" è®¾ç½®å®¹å™¨çš„å†…å­˜ä¸Šé™-p, --public=[] è®¾ç½®å®¹å™¨æš´éœ²çš„ç«¯å£-h, --hostname=\"\" è®¾ç½®å®¹å™¨çš„ä¸»æœºå-v, --volume=[] è®¾ç½®å®¹å™¨æŒ‚è½½çš„å­˜å‚¨å·ï¼Œä¹Ÿå°±æ˜¯æŒ‚è½½åˆ°å®¹å™¨çš„æŸä¸ªç›®å½•ã€‚--volumn-from=[] ç»™å®¹å™¨æŒ‚è½½å…¶ä»–å®¹å™¨ä¸Šçš„å·ï¼Œä¹Ÿå°±æ˜¯æŒ‚è½½åˆ°å®¹å™¨çš„æŸä¸ªç›®å½•ã€‚--cap-add=[] æ·»åŠ æƒé™--cap-drop=[] åˆ é™¤æƒé™--cidfile=\"\" è¿è¡Œå®¹å™¨ååœ¨æŒ‡å®šæ–‡ä»¶ä¸­å†™å…¥å®¹å™¨PIDå€¼ï¼Œè¿™æ˜¯å…¸å‹çš„ç›‘æ§ç³»ç»Ÿçš„ç”¨æ³•ã€‚--cpuset=\"\" è®¾ç½®å®¹å™¨å¯ä»¥ä½¿ç”¨é‚£äº›CPUï¼Œæ­¤å‚æ•°ç”¨æ¥è®¾ç½®å®¹å™¨ç‹¬å CPUã€‚--device=[] æ·»åŠ ä¸»æœºè®¾å¤‡ç»™å®¹å™¨ï¼Œç›¸å½“äºè®¾å¤‡ç›´é€šã€‚--dns=[] è®¾ç½®å®¹å™¨çš„DNSæœåŠ¡å™¨--dns-search=[] è®¾ç½®å®¹å™¨çš„DNSæœç´¢åŸŸåï¼Œå†™å…¥åˆ°å®¹å™¨çš„/etc/resolv.confæ–‡ä»¶ã€‚--env-file=[] è®¾ç½®ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼Œæ–‡ä»¶æ ¼å¼ä¸ºæ¯è¡Œä¸€ä¸ªç¯å¢ƒå˜é‡ã€‚--expose=[] è®¾ç½®å®¹å™¨æš´éœ²çš„ç«¯å£ï¼Œå³ä¿®æ”¹é•œåƒçš„æš´éœ²ç«¯å£ã€‚--link=[] è®¾ç½®å®¹å™¨ä¹‹é—´çš„å…³è”å…³ç³»ï¼Œä½¿ç”¨å…¶ä»–å®¹å™¨çš„IPã€envç­‰ä¿¡æ¯ã€‚--lxc-conf=[] è®¾ç½®å®¹å™¨çš„é…ç½®æ–‡ä»¶ï¼Œåªæœ‰åœ¨æŒ‡å®š--exe-driver=lxcæ—¶ä½¿ç”¨ã€‚--name=\"\" è®¾ç½®å®¹å™¨çš„åç§°ï¼Œå¯é€šè¿‡åå­—è¿›è¡Œå®¹å™¨ç®¡ç†ï¼Œlinksç‰¹æ€§éœ€è¦ä½¿ç”¨åå­—ã€‚--net=\"bridge\" å®¹å™¨ç½‘ç»œè®¾ç½®--privileged=false è®¾ç½®å®¹å™¨æ˜¯å¦ä¸ºç‰¹æƒå®¹å™¨ï¼Œç‰¹æƒå®¹å™¨æ‹¥æœ‰æ‰€æœ‰çš„capabilitiesã€‚--restart=\"no\" è®¾ç½®è®©å…¶åœæ­¢åçš„é‡å¯ç­–ç•¥--rm=false è®¾ç½®å®¹å™¨åœæ­¢åè‡ªåŠ¨åˆ é™¤å®¹å™¨ï¼Œä¸æ”¯æŒä»¥docker run -då¯åŠ¨çš„å®¹å™¨ã€‚--sig-proxy=true è®¾ç½®ç”±ä»£ç†æ¥æ”¶å¹¶å¤„ç†ä¿¡å·ï¼Œä½†SIGCHLDã€SIGSTOPã€SIGKILLä¸èƒ½è¢«ä»£ç†ã€‚# å‘½ä»¤-d, --detach Detachæ¨¡å¼ï¼Œé»˜è®¤ä¸ºå®ˆæŠ¤è¿›ç¨‹æ¨¡å¼ï¼Œå³å®¹å™¨ä»¥åå°æ–¹å¼è¿è¡Œã€‚--rm=false è‹¥å®¹å™¨å†…çš„è¿›ç¨‹ç»ˆæ­¢åˆ™è‡ªåŠ¨åˆ é™¤å®¹å™¨ï¼Œç¦æ­¢å’Œ-dé€‰é¡¹ä¸€èµ·ä½¿ç”¨ã€‚--sig-proxy=true å°†æ‰€æœ‰ä¿¡å·ä¼ é€’ç»™è¿›ç¨‹ï¼ŒéTTYæ¨¡å¼ä¹Ÿä¸€æ ·ï¼Œä½†ä¸èƒ½ä¼ é€’SIGCHLDã€SIGKILLã€SIGSTOPä¿¡å·ã€‚# è¿è¡Œä¸€ä¸ªåœ¨åå°æ‰§è¡Œçš„å®¹å™¨ï¼ŒåŒæ—¶ä½¿ç”¨æ§åˆ¶å°ç®¡ç†ã€‚$ docker run -i -t -d ubuntu:latest# è¿è¡Œä¸€ä¸ªå¸¦å‘½ä»¤ä¸”åœ¨åå°ä¸æ–­æ‰§è¡Œçš„å®¹å™¨ï¼Œä¸ç›´æ¥å±•ç¤ºå®¹å™¨å†…éƒ¨ä¿¡æ¯ã€‚$ docker run -d ubuntu:latest ping www.docker.com# è¿è¡Œä¸€ä¸ªåœ¨åå°ä¸æ–­æ‰§è¡Œçš„å®¹å™¨ï¼ŒåŒæ—¶å¸¦æœ‰å‘½ä»¤ï¼Œç¨‹åºè¢«ç»ˆæ­¢åè¿˜èƒ½é‡å¯ç»§ç»­è·‘ï¼Œå¯ç”¨æ§åˆ¶å°ç®¡ç†ã€‚$ docker run -d --restart=always ubuntu:latest ping www.docker.com# ä¸ºå®¹å™¨æŒ‡å®šä¸€ä¸ªåå­—$ docker run -d --name=ubuntu_server ubuntu:latest# å®¹å™¨æš´éœ²80ç«¯å£å¹¶æŒ‡å®šå®¿ä¸»æœº81ç«¯å£ä¸å…¶é€šä¿¡ï¼ˆå®¿ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£ï¼‰$ docker run -d --name=ubuntu -p 81:80 ubuntu:latest# æŒ‡å®šå®¹å™¨å†…ç›®å½•ä¸å®¿ä¸»æœºç›®å½•å…±äº«ï¼ˆå®¿ä¸»æœºç›®å½•:å®¹å™¨ç›®å½•ï¼‰$ docker run -d --name=ubuntu_server -v /home/www:/var/www ubuntu:latest# è®¾ç½®å®¿ä¸»æœºä¸dockerçš„å…±äº«ç›®å½•$ docker run -d -i -t -p 80:80 -v /share/swoft:/var/www/swoft --name swoft swoft/swoft /bin/bash ä½¿ç”¨docker runå¯åŠ¨å®¹å™¨ï¼Œdockeråœ¨åå°çš„æ ‡å‡†æ“ä½œæµç¨‹ï¼š æ£€æŸ¥æœ¬åœ°æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„é•œåƒï¼Œè‹¥ä¸å­˜åœ¨åˆ™ä»å…¬æœ‰ä»“åº“ä¸‹è½½ã€‚ ä½¿ç”¨é•œåƒåˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨ åˆ†é…ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶åœ¨åªè¯»çš„é•œåƒå±‚å¤–é¢æŒ‚è½½ä¸€å±‚å¯è¯»å¯å†™å±‚ã€‚ ä»å®¿ä¸»æœºé…ç½®çš„ç½‘æ¡¥æ¥å£ä¸­æ¡¥æ¥ä¸€ä¸ªè™šæ‹Ÿæœºæ¥å£åˆ°å®¹å™¨ä¸­å» ä»åœ°å€æ± åˆ†é…ä¸€ä¸ªIPåœ°å€ç»™å®¹å™¨ æ‰§è¡Œç”¨æˆ·æŒ‡å®šçš„åº”ç”¨ç¨‹åº æ‰§è¡Œå®Œæ¯•åå®¹å™¨è¢«ç»ˆæ­¢ docker create123456789101112131415161718192021222324252627282930313233343536373839# create ä½¿ç”¨æŒ‡å®šçš„é•œåƒåˆ›å»ºå®¹å™¨ï¼Œä¸runå‘½ä»¤ä¸åŒçš„æ˜¯ï¼Œä½¿ç”¨createå‘½ä»¤åªèƒ½åˆ›å»ºå®¹å™¨è€Œå¹¶ä¸å¯åŠ¨ã€‚$ docker create [é€‰é¡¹] &lt;é•œåƒåç§°,id&gt; &lt;å‘½ä»¤&gt; [å‚æ•°]# é€‰é¡¹-a, --attach=[] å°†æ ‡å‡†è¾“å…¥ã€æ ‡å‡†è¾“å‡ºã€æ ‡å‡†é”™è¯¯é“¾æ¥åˆ°å®¹å™¨-C, --cpu-shares=0 è®¾ç½®CPUèµ„æºåˆ†é…ï¼Œé»˜è®¤ä¸º1024ã€‚-e, --env=[] å‘å®¹å™¨è®¾å¤‡ç¯å¢ƒå˜é‡ï¼Œç”¨äºä¼ é€’è®¾ç½®æˆ–å¯†ç ã€‚-h, --hostname=\"\" è®¾ç½®å®¹å™¨ä¸»æœºå-i, --interactive=false æ¿€æ´»æ ‡å‡†è¾“å…¥ï¼Œå³ä½¿æœªä¸å®¹å™¨è¿æ¥ï¼Œä¹Ÿç»´æŒæ ‡å‡†è¾“å…¥ã€‚-m, --memory=\"\" è®¾ç½®å†…å­˜é™åˆ¶ï¼Œæ ¼å¼&lt;æ•°å­—&gt;&lt;å•ä½&gt;ï¼Œå•ä½å¯ç”¨bã€kã€mã€gã€‚-P, --publish-all=false å°†è¿æ¥åˆ°ä¸»æœºçš„å®¹å™¨çš„æ‰€æœ‰ç«¯å£æš´éœ²åœ¨å¤–-p, --publish=[] å°†è¿æ¥åˆ°ä¸»æœºçš„å®¹å™¨çš„ç‰¹å®šç«¯å£æš´éœ²åœ¨å¤–ï¼Œä¸»è¦ç”¨äºæš´éœ²webæœåŠ¡å™¨çš„ç«¯å£ã€‚-t, --tty=false ä½¿ç”¨TTYæ¨¡å¼ï¼Œè‹¥è¦ä½¿ç”¨Bashåˆ™å¿…é¡»è®¾ç½®è¯¥é€‰é¡¹ã€‚-u, --user=\"\" è®¾ç½®å®¹å™¨è¿è¡Œæ—¶è¦ä½¿ç”¨çš„Linuxç”¨æˆ·è´¦æˆ·å’ŒUID-v, --volume=[] è®¾ç½®æ•°æ®å·ï¼Œè®¾ç½®è¦ä¸ä¸»æœºå…±äº«çš„ç›®å½•ï¼Œä¸å°†æ–‡ä»¶ä¿å­˜åˆ°å®¹å™¨è€Œæ˜¯ç›´æ¥ä¿å­˜åˆ°ä¸»æœºï¼Œåœ¨ä¸»æœºç›®å½•åæ·»åŠ :roä¸:rwè¿›è¡Œè¯»å†™è®¾ç½®ï¼Œé»˜è®¤æœª:rwã€‚-w, --workdir=\"\" è®¾ç½®å®¹å™¨å†…éƒ¨è¦è¿è¡Œè¿›ç¨‹çš„ç›®å½•-add-host=[] å‘å®¹å™¨çš„/etc/hostsæ·»åŠ ä¸»æœºåä¸IPåœ°å€--cap-add=[] è®¾ç½®å®¹å™¨ä¸­ä½¿ç”¨çš„cgroupsçš„ç‰¹å®šcapablityï¼Œè‹¥è®¾ç½®ä¸ºallåˆ™ä½¿ç”¨æ‰€æœ‰çš„capablityã€‚--cap-drop=[] ä»å®¹å™¨ä¸­åˆ é™¤cgroupçš„ç‰¹å®šcapablityã€‚--cidfile=\"\" è®¾ç½®cidæ–‡ä»¶è·¯å¾„ï¼Œcidä¸­å­˜å‚¨ç€æ‰€åˆ›å»ºå®¹å™¨çš„idã€‚--cpuset=\"\" åœ¨å¤šæ ¸CPUä¸­è®¾ç½®è¦è¿è¡Œå®¹å™¨çš„æ ¸å¿ƒæ•°--device=[] æ·»åŠ ä¸»æœºè®¾å¤‡åˆ°å®¹å™¨ï¼Œæ ¼å¼ä¸º&lt;ä¸»æœºè®¾å¤‡&gt;:&lt;å®¹å™¨è®¾å¤‡&gt;--dns=[] è®¾ç½®å®¹å™¨ä¸­ä½¿ç”¨çš„DNSæœåŠ¡å™¨--dns-search=[] è®¾ç½®dockerä¸­è¦ä½¿ç”¨çš„DNSæœç´¢åŸŸ--entrypoint=\"\" å¿½ç•¥Dockerfileçš„ENTRYPOINTè®¾ç½®ï¼Œå¼ºåˆ¶è®¾ç½®ä¸ºå…¶ä»–å€¼ã€‚--env-file=[] å‘å®¹å™¨åº”ç”¨è®¾ç½®ç¯å¢ƒå˜é‡æ–‡ä»¶--expose=[] ä»…è¿æ¥å®¹å™¨çš„ç«¯å£å’Œä¸»æœºï¼Œå¹¶ä¸æš´éœ²åœ¨å¤–ã€‚--link=[] è¿›è¡Œå®¹å™¨è¿æ¥ï¼Œæ ¼å¼ &lt;å®¹å™¨åç§°&gt;:&lt;åˆ«å&gt;--lxc-conf=[] è‹¥ä½¿ç”¨LXCé©±åŠ¨åˆ™å¯è®¾ç½®LXCé€‰é¡¹--name è®¾ç½®å®¹å™¨åç§°--net=\"bridge\" è®¾ç½®å®¹å™¨çš„ç½‘ç»œæ¨¡å¼--privileged=false åœ¨å®¹å™¨å†…éƒ¨ä½¿ç”¨ä¸»æœºçš„æ‰€æœ‰linuxå†…æ ¸åŠŸèƒ½--restart=\"\" è®¾ç½®å®¹å™¨å†…éƒ¨è¿›ç¨‹ç»ˆæ­¢æ—¶é‡å¯ç­–ç•¥--security-opt=[] è®¾ç½®SELinuxã€AppArmoré€‰é¡¹--volumn-from=[] è¿æ¥æ•°æ®å·å®¹å™¨ï¼Œè®¾ç½®æ ¼å¼æœª&lt;å®¹å™¨åç§°,id&gt;:&lt;:ro, :rw&gt;ï¼Œé»˜è®¤è¯»å†™è®¾ç½®éµä»-vé€‰é¡¹çš„è®¾ç½®ã€‚# ä½¿ç”¨dockeré•œåƒnginx:lateståˆ›å»ºä¸€ä¸ªå®¹å™¨åä¸ºubuntu_serve$ docker create --name ubuntu_serve ubuntu:latest$ docker create -it --name ubuntu_server ubutnu:latest /bin/bash docker start123456# startç”¨äºå¯åŠ¨å®¹å™¨$ docker start &lt;é€‰é¡¹&gt;&lt;å®¹å™¨åç§°, id&gt;# é€‰é¡¹-a, --attach=false å°†æ ‡å‡†è¾“å…¥ã€æ ‡å‡†è¾“å‡ºã€æ ‡å‡†é”™è¯¯è¿æ¥åˆ°å®¹å™¨ï¼Œä¼ é€’æ‰€æœ‰ä¿¡å·ã€‚-i, --interactive=false æ¿€æ´»æ ‡å‡†è¾“å…¥ docker stop12345# stopç”¨äºç»ˆæ­¢å®¹å™¨$ docker stop &lt;é€‰é¡¹&gt;&lt;å®¹å™¨åç§°, id&gt;# é€‰é¡¹-t, --timeout=10 è®¾ç½®ç»ˆæ­¢å®¹å™¨å‰çš„ç­‰å¾…æ—¶é—´ï¼Œå•ä½ä¸ºç§’ã€‚ docker restart12# restart ç”¨äºé‡å¯å®¹å™¨$ docker restart [é€‰é¡¹] &lt;å®¹å™¨åç§°, id&gt; docker pause12# pause ç”¨äºæš‚åœå®¹å™¨ä¸­æ‰€æœ‰çš„è¿›ç¨‹$ docker pause [é€‰é¡¹] &lt;å®¹å™¨åç§°, id&gt; docker unpause12# unpauseç”¨äºé‡å¯ä½¿ç”¨pauseå‘½ä»¤æš‚åœçš„å®¹å™¨$ docker unpause &lt;å®¹å™¨åç§°, id&gt; docker kill12345678# killç”¨äºæ€æ‰ä¸€ä¸ªè¿è¡Œä¸­çš„å®¹å™¨ï¼Œå‘é€SIGKILLä¿¡å·æ¥åœæ­¢çš„ä¸»è¿›ç¨‹ã€‚$ docker kill [é€‰é¡¹] &lt;å®¹å™¨åç§°, id&gt;# é€‰é¡¹-s å‘å®¹å™¨å‘é€ä¸€ä¸ªä¿¡å·# æ€æ­»è¿è¡Œä¸­çš„å®¹å™¨nginx$ docker kill -s KILL nginx docker rm12345678910111213# rmç”¨äºåˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨$ docker rm [é€‰é¡¹] &lt;å®¹å™¨åç§°,id&gt;# é€‰é¡¹-f é€šè¿‡SIGKILLä¿¡å·å¼ºåˆ¶åˆ é™¤ä¸€ä¸ªè¿è¡Œä¸­çš„å®¹å™¨-l ç§»é™¤å®¹å™¨é—´çš„ç½‘è·¯è¿æ¥è€Œéå®¹å™¨æœ¬èº«-v åˆ é™¤ä¸å®¹å™¨å…³è”çš„å·# å¼ºåˆ¶åˆ é™¤å®¹å™¨test$ docker rm -f test# åˆ é™¤å®¹å™¨testå¹¶åˆ é™¤æŒ‚è½½çš„æ•°æ®å·$ docke rm -v test docker exec12345678910# exec ç”¨äºåœ¨è¿è¡Œä¸­çš„å®¹å™¨ä¸­æ‰§è¡Œå‘½ä»¤$ docker exec [é€‰é¡¹] &lt;å®¹å™¨åç§°, id&gt; &lt;å‘½ä»¤&gt; [å‚æ•°]# é€‰é¡¹-d åˆ†ç¦»æ¨¡å¼å³åœ¨åå°è¿è¡Œ-i å³ä½¿æ²¡æœ‰é™„åŠ ä¹Ÿä¿æŒSTDINæ ‡å‡†è¾“å…¥æ‰“å¼€-t åˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯# åœ¨å®¹å™¨testä¸­ä»¥äº¤äº’æ¨¡å¼æ‰§è¡Œå®¹å™¨å†…/root/test.shè„šæœ¬$ docker exec -it test /bin/sh /root/test.sh å®¹å™¨æ“ä½œdocker ps123456789101112# psç”¨äºè¾“å‡ºå®¹å™¨åˆ—è¡¨$ docker ps &lt;é€‰é¡¹&gt;# é€‰é¡¹-a, --all=false åˆ—å‡ºæ‰€æœ‰å®¹å™¨ï¼Œä¸å¸¦-aåˆ™è¾“å‡ºå½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨ã€‚--before=\"\" åˆ—å‡ºç‰¹å®šå®¹å™¨åˆ›å»ºå‰çš„å®¹å™¨ï¼ŒåŒ…å«åœæ­¢çš„å®¹å™¨ã€‚-f, --filter=[] è®¾ç½®è¾“å‡ºè¿‡æ»¤-l, --latest=false åˆ—å‡ºæœ€ååˆ›å»ºçš„å®¹å™¨åŒ…å«åœæ­¢çš„å®¹å™¨-q, --quiet=false åªè¾“å‡ºå®¹å™¨çš„ID$ docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES docker top1234# topç”¨æˆ·æ˜¾ç¤ºå®¹å™¨ä¸­æ­£åœ¨ è¿è¡Œçš„è¿›ç¨‹ä¿¡æ¯$ docker top &lt;å®¹å™¨åç§°, id&gt;&lt;psé€‰é¡¹&gt;$ docker top docker attach12# attach ç”¨äºå°†æ ‡å‡†è¾“å…¥ä¸æ ‡å‡†è¾“å‡ºè¿æ¥åˆ°æ­£åœ¨è¿è¡Œçš„å®¹å™¨$ docker attach &lt;é€‰é¡¹&gt;&lt;å®¹å™¨åç§°, id&gt; docker logs1234567891011121314# logsç”¨äºè·å–å®¹å™¨çš„æ—¥å¿—$ docker logs [é€‰é¡¹] &lt;å®¹å™¨åç§°,id&gt;# é€‰é¡¹-f è·Ÿè¸ªæ—¥å¿—è¾“å‡º--since æ˜¾ç¤ºæŸä¸ªå¼€å§‹æ—¶é—´çš„æ‰€æœ‰æ—¥å¿—-t æ˜¾ç¤ºæ—¶é—´æˆ³--tail ä»…ä»…åˆ—å‡ºæœ€æ–°næ¡å®¹å™¨æ—¥å¿—# è·Ÿè¸ªæŸ¥çœ‹testå®¹å™¨çš„æ—¥å¿—$ docker logs -f test# æŸ¥çœ‹testå®¹å™¨ä»2019å¹´4æœˆ1æ—¥ä»¥åçš„æœ€æ–°10æ¡æ—¥å¿—$ docker logs --since=\"2019-04-01\" --tail=10 test å¦‚ä½•åŠ¨æ€è·Ÿè¸ªå¹¶æŸ¥çœ‹myswoftå®¹å™¨çš„æ—¥å¿—è¯¦æƒ…å‘¢ï¼Ÿ 1docker@ ~$: docker logs -tf --details myswoft å¦‚ä½•æ¸…ç†æ—¥å¿—æ–‡ä»¶å‘¢ï¼Ÿ Dockeræ—¥å¿—é»˜è®¤å­˜å‚¨ä½äºï¼š/var/lib/docker/containers//*.log 12345678910111213141516171819202122# åœ¨dockerä¸­åˆ‡æ¢ä¸ºrootç”¨æˆ·docker@default: ~$ su -i# æŸ¥çœ‹dockerå®¹å™¨çš„idroot@default: ~$ docker ps -a | grep myswoftd26ff0ff1bc0 swoft/swoft \"php /var/www/swoft/â€¦\" 2 weeks ago Up 22 minutes 0.0.0.0:80-&gt;80/tcp myswoft# æŸ¥çœ‹å®¹å™¨æ—¥å¿—æ–‡ä»¶å¤§å°root@default: ~$ ls -lh $(find /var/lib/docker/containers/ -name *-json.log)-rw-r----- 1 root root 0 May 14 13:32 /var/lib/docker/containers/d26ff0ff1bc0dc0221ce5be7f78da96123a0ddbb379ab8befd2d1403f44e820b/d26ff0ff1bc0dc0221ce5be7f78da96123a0ddbb379ab8befd2d1403f44e820b-json.log# è¿›å…¥æ—¥å¿—ç›®å½•root@default: ~$ cd /var/lib/docker/containers/d26ff0ff1bc0dc0221ce5be7f78da96123a0ddbb379ab8befd2d1403f44e820b# ä¸´æ—¶æ¸…ç†æ—¥å¿—æ–‡ä»¶root@default: /var.../$ truncate -s 0 /var/lib/docker/containers/&lt;container_id&gt;/*-json.log# ä¸´æ—¶æ¸…ç†æ—¥å¿—æ–‡ä»¶root@default: /var../$ cat /dev/null &gt; *-json.log# ä½¿ç”¨rmåˆ é™¤æ—¥å¿—æ–‡ä»¶åæ˜¯éœ€è¦é‡å¯å®¹å™¨çš„ï¼Œå¦‚æœå®¹å™¨è¿è¡ŒçŠ¶æ€ä¸‹Linuxè¿›ç¨‹ä¼šå¼•ç”¨ç€ä¸ä¼šé‡Šæ”¾ç£ç›˜ç©ºé—´ã€‚root@default /var/.../$ rm -rf *-json.log docker port12345# portç”¨äºåˆ—å‡ºæŒ‡å®šå®¹å™¨çš„ç«¯å£æ˜ å°„ï¼Œæˆ–è€…ç”¨äºæŸ¥æ‰¾å°†PRIVATE_PORT NATåˆ°é¢å‘å…¬ä¼—çš„ç«¯å£ã€‚$ docker port [é€‰é¡¹] &lt;å®¹å™¨åç§°,id&gt; [PRIVATE_PORT[/PROTO]]# æŸ¥çœ‹testå®¹å™¨çš„ç«¯å£æ˜ å°„æƒ…å†µ$ docker port test é•œåƒä»“åº“docker search1234567# searchç”¨äºåœ¨docker hubä¸­æœç´¢é•œåƒ$ docker search &lt;é€‰é¡¹&gt;&lt;æœç´¢å…³é”®è¯&gt;# é€‰é¡¹--automated=false åªæ˜¾ç¤ºç”±docker hubçš„automated buildåˆ›å»ºçš„é•œåƒ--no-trunc=false æ˜¾ç¤ºæ‰€æœ‰å› å†…å®¹è¿‡é•¿è€Œçœç•¥çš„éƒ¨åˆ†-s, --stars=0 æ˜¾ç¤ºæœ‰ç‰¹å®šæ˜Ÿçº§ä»¥ä¸Šçš„é•œåƒ æœ¬åœ°é•œåƒdocker images12345678910# imagesç”¨äºè¾“å‡ºé•œåƒåˆ—è¡¨$ docker images &lt;é€‰é¡¹&gt;&lt;é•œåƒåç§°, id&gt;# é€‰é¡¹-a, --all=false åˆ—å‡ºæ‰€æœ‰é•œåƒåŒ…å«çˆ¶é•œåƒã€‚-f, --filter=[] è®¾ç½®è¾“å‡ºç»“æœè¿‡æ»¤ï¼Œè‹¥è®¾ç½®ä¸ºdangling=trueåˆ™ä»…è¾“å‡ºæ— åé•œåƒã€‚--no-trunc=false æ˜¾ç¤ºæ‰€æœ‰å› å†…å®¹è¿‡é•¿è€Œçœç•¥çš„éƒ¨åˆ†$ docker imagesREPOSITORY TAG IMAGE ID CREATED SIZE docker rmi123456789# rmi ç”¨äºåˆ é™¤é•œåƒï¼Œè‹¥æ²¡æœ‰æŒ‡å®šæ ‡ç­¾åˆ™ä¼šåˆ é™¤latestæ ‡ç­¾ã€‚$ docker rmi &lt;æ³¨å†Œåç§°&gt;/&lt;é•œåƒåç§°, id&gt;:&lt;æ ‡ç­¾&gt;# é€‰é¡¹-f, --force=false å¼ºåˆ¶åˆ é™¤é•œåƒ--no-prune=false ä¸åˆ é™¤ä¸å¸¦æ ‡ç­¾çš„çˆ¶çº§é•œåƒ# åˆ é™¤æ‰€æœ‰é•œåƒ$ docker rm -f $(docker ps -a -q) docker tag12345# tagç”¨äºè®¾ç½®é•œåƒæ ‡ç­¾$ docker tag &lt;é€‰é¡¹&gt;&lt;é•œåƒåç§°&gt;:&lt;æ ‡ç­¾&gt;&lt;æ³¨å†Œåœ°å€, ç”¨æˆ·å&gt;/&lt;é•œåƒåç§°&gt;:&lt;æ ‡ç­¾&gt;# é€‰é¡¹- f, --force=false å¼ºåˆ¶è®¾ç½®ï¼Œå³ä½¿å·²æ‹¥æœ‰æ ‡ç­¾ï¼Œå¦‚è¿œç¨‹ä»“åº“è®¾ç½®æ ‡ç­¾ã€‚ docker save12345# saveç”¨äºå°†é•œåƒä¿å­˜ä¸ºtagåŒ…æ–‡ä»¶$ docker save &lt;é€‰é¡¹&gt;&lt;é•œåƒåç§°&gt;:&lt;æ ‡ç­¾&gt;# é€‰é¡¹-o, --output=\"\" è®¾ç½®ä¿å­˜æ—¶çš„æ–‡ä»¶åç§° è‹¥ä¸è®¾ç½®-oé€‰é¡¹ï¼ŒtaråŒ…æ–‡ä»¶ä¼šè¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºï¼Œæ‰€ä»¥å¿…é¡»è®¾ç½®é‡å®šå‘ã€‚å¦‚æœä»…æŒ‡å®šé•œåƒåç§°ä½†æ²¡æœ‰æŒ‡æŒ‡å®šæ ‡ç­¾ï¼Œåˆ™ä¼šå°†æ‰€æœ‰æ ‡ç­¾éƒ½ä¿å­˜åˆ°ä¸€ä¸ªtaråŒ…æ–‡ä»¶ä¸­ã€‚ ä¿¡æ¯æŸ¥çœ‹docker info12345678910111213141516171819202122232425262728293031323334353637383940414243444546# infoç”¨äºæ˜¾ç¤ºå½“å‰ç³»ç»Ÿä¿¡æ¯ã€dockerå®¹å™¨å’Œé•œåƒæ•°é‡ã€è®¾ç½®ç­‰ä¿¡æ¯ã€‚$ docker infoContainers: 0 Running: 0 Paused: 0 Stopped: 0Images: 0Server Version: 18.09.5Storage Driver: overlay2 Backing Filesystem: extfs Supports d_type: true Native Overlay Diff: trueLogging Driver: json-fileCgroup Driver: cgroupfsPlugins: Volume: local Network: bridge host macvlan null overlay Log: awslogs fluentd gcplogs gelf journald json-file local logentries splunk syslogSwarm: inactiveRuntimes: runcDefault Runtime: runcInit Binary: docker-initcontainerd version: bb71b10fd8f58240ca47fbb579b9d1028eea7c84runc version: 2b18fe1d885ee5083ef9f0838fee39b62d653e30init version: fec3683Security Options: seccomp Profile: defaultKernel Version: 4.14.111-boot2dockerOperating System: Boot2Docker 18.09.5 (TCL 8.2.1)OSType: linuxArchitecture: x86_64CPUs: 1Total Memory: 989.4MiBName: defaultID: 7ST2:CIQM:GLVF:AUF2:QFKR:N2LB:FSO7:V6UJ:5IFN:MQVZ:WK7L:TGSSDocker Root Dir: /mnt/sda1/var/lib/dockerDebug Mode (client): falseDebug Mode (server): falseRegistry: https://index.docker.io/v1/Labels: provider=virtualboxExperimental: falseInsecure Registries: 127.0.0.0/8Live Restore Enabled: false docker version123456789101112131415161718192021# versionç”¨æˆ·è¾“å‡ºdockerçš„ç‰ˆæœ¬ä¿¡æ¯$ docker versionClient: Version: 18.03.0-ce API version: 1.37 Go version: go1.9.4 Git commit: 0520e24302 Built: Fri Mar 23 08:31:36 2018 OS/Arch: windows/amd64 Experimental: false Orchestrator: swarmServer: Docker Engine - Community Engine: Version: 18.09.5 API version: 1.39 (minimum version 1.12) Go version: go1.10.8 Git commit: e8ff056dbc Built: Thu Apr 11 04:50:00 2019 OS/Arch: linux/amd64 Experimental: false ###æ‰¹é‡æ“ä½œ æ€æ­»å®¹å™¨docker kill $(docker ps -a -q) ####åœæ­¢æ‰€æœ‰ docker stop $(docker ps-a-q) åˆ é™¤æ‰€æœ‰docker rmi $(docker images -q) å¼ºè¡Œåˆ é™¤docker rmi --force (docker images | grep doss-api | awk &#39;{print3}&#39;) æŸ¥çœ‹å¸®åŠ©123456789101112131415161718192021222324252627282930313233343536373839404142434445464748docker-compose -h# -f æŒ‡å®šä½¿ç”¨çš„ Compose æ¨¡æ¿æ–‡ä»¶# é»˜è®¤ä¸º docker-compose.ymlï¼Œå¯ä»¥å¤šæ¬¡æŒ‡å®šã€‚docker-compose -f docker-compose.yml up -d #å¯åŠ¨æ‰€æœ‰å®¹å™¨ï¼Œ-d å°†ä¼šåœ¨åå°å¯åŠ¨å¹¶è¿è¡Œæ‰€æœ‰çš„å®¹å™¨docker-compose up -d#åœç”¨ç§»é™¤æ‰€æœ‰å®¹å™¨ä»¥åŠç½‘ç»œç›¸å…³docker-compose down#æŸ¥çœ‹æœåŠ¡å®¹å™¨çš„è¾“å‡ºdocker-compose logs#åˆ—å‡ºé¡¹ç›®ä¸­ç›®å‰çš„æ‰€æœ‰å®¹å™¨docker-compose ps#æ„å»ºï¼ˆé‡æ–°æ„å»ºï¼‰é¡¹ç›®ä¸­çš„æœåŠ¡å®¹å™¨ã€‚æœåŠ¡å®¹å™¨ä¸€æ—¦æ„å»ºåï¼Œå°†ä¼šå¸¦ä¸Šä¸€ä¸ªæ ‡è®°å.#ä¾‹å¦‚å¯¹äº web é¡¹ç›®ä¸­çš„ä¸€ä¸ª db å®¹å™¨ï¼Œå¯èƒ½æ˜¯ web_dbã€‚#å¯ä»¥éšæ—¶åœ¨é¡¹ç›®ç›®å½•ä¸‹è¿è¡Œ docker-compose build æ¥é‡æ–°æ„å»ºæœåŠ¡docker-compose build# ä¸å¸¦ç¼“å­˜çš„æ„å»ºã€‚docker-compose build --no-cache#æ‹‰å–æœåŠ¡ä¾èµ–çš„é•œåƒdocker-compose pull#é‡å¯é¡¹ç›®ä¸­çš„æœåŠ¡docker-compose restart#åˆ é™¤æ‰€æœ‰ï¼ˆåœæ­¢çŠ¶æ€çš„ï¼‰æœåŠ¡å®¹å™¨ã€‚#æ¨èå…ˆæ‰§è¡Œ docker-compose stop å‘½ä»¤æ¥åœæ­¢å®¹å™¨ã€‚docker-compose rm #åœ¨æŒ‡å®šæœåŠ¡ä¸Šæ‰§è¡Œä¸€ä¸ªå‘½ä»¤ã€‚docker-compose run ubuntu ping docker.com#è®¾ç½®æŒ‡å®šæœåŠ¡è¿è¡Œçš„å®¹å™¨ä¸ªæ•°ã€‚é€šè¿‡ service=num çš„å‚æ•°æ¥è®¾ç½®æ•°é‡docker-compose scale web=3 db=2#å¯åŠ¨å·²ç»å­˜åœ¨çš„æœåŠ¡å®¹å™¨ã€‚docker-compose start#åœæ­¢å·²ç»å¤„äºè¿è¡ŒçŠ¶æ€çš„å®¹å™¨ï¼Œä½†ä¸åˆ é™¤å®ƒã€‚#é€šè¿‡ docker-compose start å¯ä»¥å†æ¬¡å¯åŠ¨è¿™äº›å®¹å™¨ã€‚docker-compose stop","categories":[{"name":"Server","slug":"Server","permalink":"https://mrjerryli.github.io/categories/Server/"},{"name":"Docker","slug":"Server/Docker","permalink":"https://mrjerryli.github.io/categories/Server/Docker/"}],"tags":[{"name":"centos","slug":"centos","permalink":"https://mrjerryli.github.io/tags/centos/"}],"keywords":[{"name":"Server","slug":"Server","permalink":"https://mrjerryli.github.io/categories/Server/"},{"name":"Docker","slug":"Server/Docker","permalink":"https://mrjerryli.github.io/categories/Server/Docker/"}]},{"title":"dockeræ­å»ºredisé›†ç¾¤","slug":"dockeræ­å»ºredisé›†ç¾¤","date":"2020-05-19T03:46:20.000Z","updated":"2020-05-19T03:50:27.627Z","comments":true,"path":"post/1672ce0a.html","link":"","permalink":"https://mrjerryli.github.io/post/1672ce0a.html","excerpt":"","text":"Docker-composeéƒ¨ç½²redis-clusteré›†ç¾¤å‚è€ƒé“¾æ¥ï¼šhttps://www.jianshu.com/p/b7dea62bcd8b å‚è€ƒé•œåƒï¼šhttps://github.com/publicisworldwide/docker-stacks/tree/master/oracle-linux/environments/storage/redis-cluster 1.åˆ›å»ºæ•°æ®ç›®å½• root@rede:# pwd /data/redis root@rede:# mkdir 700&#123;1..6&#125; ##è¿™ä¸ªç›®å½•å’Œä¸‹è¾¹ymlæ–‡ä»¶çš„volumeså¯¹åº” root@rede:# mkdir 700&#123;1..6&#125;/data root@rede:# ls 7001 7002 7003 7004 7005 7006 docker-compose.yml 2.åˆ›å»ºä¸€ä¸ªdocker-compose.ymlæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š version: '3' services: redis1: image: publicisworldwide/redis-cluster network_mode: host restart: always volumes: - /data/redis/7001/data:/data environment: - REDIS_PORT=7001 redis2: image: publicisworldwide/redis-cluster network_mode: host restart: always volumes: - /data/redis/7002/data:/data environment: - REDIS_PORT=7002 redis3: image: publicisworldwide/redis-cluster network_mode: host restart: always volumes: - /data/redis/7003/data:/data environment: - REDIS_PORT=7003 redis4: image: publicisworldwide/redis-cluster network_mode: host restart: always volumes: - /data/redis/7004/data:/data environment: - REDIS_PORT=7004 redis5: image: publicisworldwide/redis-cluster network_mode: host restart: always volumes: - /data/redis/7005/data:/data environment: - REDIS_PORT=7005 redis6: image: publicisworldwide/redis-cluster network_mode: host restart: always volumes: - /data/redis/7006/data:/data environment: - REDIS_PORT=7006 è¿™é‡Œç”¨çš„åˆ«äººä¸€ä¸ªç°æˆçš„é•œåƒ publicisworldwide/redis-cluster ï¼Œè‡ªå·±åˆ¶ä½œä¹Ÿå¯ä»¥ï¼Œåç»­ä¼šå‘å¸ƒåˆ¶ä½œè¿‡ç¨‹ï¼Œä¸è¿‡ä¸å»ºè®®è‡ªå·±åšï¼Œæœ‰ä»€ä¹ˆéœ€è¦æ›´æ”¹çš„å¯ä»¥åœ¨ç°æœ‰çš„é•œåƒåŸºç¡€ä¸Šè¿›è¡Œæ›´æ”¹ä¹‹åcommitã€‚é•œåƒå¯ä»¥è‡ªå·±ä¸‹è½½ï¼Œä¹Ÿå¯ä»¥ç­‰å¯åŠ¨æœåŠ¡çš„æ—¶å€™ä»–è‡ªåŠ¨ä¸‹è½½ã€‚ è¿™é‡Œç”¨çš„æ˜¯hostç½‘ç»œæ¨¡å¼ï¼ŒredisæŒ‚è½½åˆ°ä¹‹å‰åˆ›å»ºçš„ç›®å½•ä¸‹ã€‚ å¦‚æœä¸æƒ³ä½¿ç”¨ä¸»æœºæ¨¡å¼å¯ä»¥æ–‡ç« å¼€å¤´çš„é“¾æ¥ï¼Œå…·ä½“æˆ‘è¿™é‡Œå°±ä¸å†™äº†ï¼Œè‡ªå·±çœ‹ã€‚è‡³äºdocker-composeçš„å®‰è£…ç½‘ä¸Šä¸€å¤§å †æ–‡ç« ï¼Œè¿™é‡Œä¸èµ˜è¿°ã€‚ 3.åˆ›å»ºæ–‡ä»¶ä¹‹åï¼Œå¯åŠ¨æœåŠ¡ root@rede: docker-compose up -d Creating redis_redis1_1 ... done Creating redis_redis5_1 ... done Creating redis_redis4_1 ... done Creating redis_redis3_1 ... done Creating redis_redis6_1 ... done Creating redis_redis2_1 ... done root@rede: docker-compose ps Name Command State Ports --------------------------------------------------------------- redis_redis1_1 /usr/local/bin/entrypoint. ... Up redis_redis2_1 /usr/local/bin/entrypoint. ... Up redis_redis3_1 /usr/local/bin/entrypoint. ... Up redis_redis4_1 /usr/local/bin/entrypoint. ... Up redis_redis5_1 /usr/local/bin/entrypoint. ... Up redis_redis6_1 /usr/local/bin/entrypoint. ... Up çŠ¶æ€éƒ½ä¸ºUpï¼Œè¯´æ˜æœåŠ¡å‡æ­£å¸¸å¯åŠ¨ï¼Œå¦‚æœæœ‰çŠ¶æ€ä¸æ­£å¸¸çš„å®¹å™¨ï¼Œçœ‹çœ‹è‡ªå·±æœåŠ¡å™¨çš„ç«¯å£æ˜¯ä¸æ˜¯è¢«å ç”¨äº†ã€‚ 4.redis-clusteré›†ç¾¤é…ç½® ä¸Šè¿°åªæ˜¯å¯åŠ¨äº†6ä¸ªrediså®¹å™¨ï¼Œå¹¶æ²¡æœ‰è®¾ç½®é›†ç¾¤ï¼Œéšä¾¿è¿›å…¥ä¸€ä¸ªrediså®¹å™¨ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼ŒIPæ›¿æ¢æˆè‡ªå·±å®¿ä¸»æœºçš„IP root@rede:&#x2F;data&#x2F;redis â–¶ docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES a0c7047c2a0e publicisworldwide&#x2F;redis-cluster &quot;&#x2F;usr&#x2F;local&#x2F;bin&#x2F;entrâ€¦&quot; 2 minutes ago Up 2 minutes redis_redis3_1 f165a7c962ca publicisworldwide&#x2F;redis-cluster &quot;&#x2F;usr&#x2F;local&#x2F;bin&#x2F;entrâ€¦&quot; 2 minutes ago Up 2 minutes redis_redis1_1 8ce8ec23974e publicisworldwide&#x2F;redis-cluster &quot;&#x2F;usr&#x2F;local&#x2F;bin&#x2F;entrâ€¦&quot; 2 minutes ago Up 2 minutes redis_redis4_1 1c37f7b71a21 publicisworldwide&#x2F;redis-cluster &quot;&#x2F;usr&#x2F;local&#x2F;bin&#x2F;entrâ€¦&quot; 2 minutes ago Up 2 minutes redis_redis6_1 810b0ff90710 publicisworldwide&#x2F;redis-cluster &quot;&#x2F;usr&#x2F;local&#x2F;bin&#x2F;entrâ€¦&quot; 2 minutes ago Up 2 minutes redis_redis2_1 e5a38e1cc280 publicisworldwide&#x2F;redis-cluster &quot;&#x2F;usr&#x2F;local&#x2F;bin&#x2F;entrâ€¦&quot; 2 minutes ago Up 2 minutes redis_redis5_1 df94ddfb5d1f zookeeper:3.4.11 &quot;&#x2F;docker-entrypoint.â€¦&quot; 20 hours ago Up 20 hours 2888&#x2F;tcp, 3888&#x2F;tcp, 0.0.0.0:2182-&gt;2181&#x2F;tcp zookeeper_2 5eb43213b27a zookeeper:3.4.11 &quot;&#x2F;docker-entrypoint.â€¦&quot; 20 hours ago Up 20 hours 2888&#x2F;tcp, 3888&#x2F;tcp, 0.0.0.0:2183-&gt;2181&#x2F;tcp zookeeper_3 d17a6180907e zookeeper:3.4.11 &quot;&#x2F;docker-entrypoint.â€¦&quot; 20 hours ago Up 20 hours 2888&#x2F;tcp, 0.0.0.0:2181-&gt;2181&#x2F;tcp, 3888&#x2F;tcp zookeeper_1 root@rede:# docker exec -ti d3a904cc0d5a bash root@rede:&#x2F;data# redis-cli --cluster create 192.168.1.100:7001 192.168.1.100:7002 192.168.1.100:7003 192.168.1.100:7004 192.168.1.100:7005 192.168.1.100:7006 --cluster-replicas 1 &gt;&gt;&gt; Performing hash slots allocation on 6 nodes... Master[0] -&gt; Slots 0 - 5460 Master[1] -&gt; Slots 5461 - 10922 Master[2] -&gt; Slots 10923 - 16383 Adding replica 192.168.1.100:7004 to 192.168.1.100:7001 Adding replica 192.168.1.100:7005 to 192.168.1.100:7002 Adding replica 192.168.1.100:7006 to 192.168.1.100:7003 &gt;&gt;&gt; Trying to optimize slaves allocation for anti-affinity [WARNING] Some slaves are in the same host as their master M: 7237efa105ff4246c02da08c0e65c18246755f2f 192.168.1.100:7001 slots:[0-5460] (5461 slots) master M: 241d6eb2abcd9a6d41db5231fcd80fac1d452bee 192.168.1.100:7002 slots:[5461-10922] (5462 slots) master M: 493083f2733bc181295f5b9a9fa9bc6fdf821958 192.168.1.100:7003 slots:[10923-16383] (5461 slots) master S: b60ef6cbea0ae06566d17db4a1b4452e56543419 192.168.1.100:7004 replicates 241d6eb2abcd9a6d41db5231fcd80fac1d452bee S: b48e546e963f694eac91d49b285040bb2bec5513 192.168.1.100:7005 replicates 493083f2733bc181295f5b9a9fa9bc6fdf821958 S: 259de2d6be917e64cdc01604521da45cc1f8d842 192.168.1.100:7006 replicates 7237efa105ff4246c02da08c0e65c18246755f2f Can I set the above configuration? (type &#39;yes&#39; to accept): yes &gt;&gt;&gt; Nodes configuration updated &gt;&gt;&gt; Assign a different config epoch to each node &gt;&gt;&gt; Sending CLUSTER MEET messages to join the cluster Waiting for the cluster to join .... &gt;&gt;&gt; Performing Cluster Check (using node 192.168.1.100:7001) M: 7237efa105ff4246c02da08c0e65c18246755f2f 192.168.1.100:7001 slots:[0-5460] (5461 slots) master 1 additional replica(s) M: 241d6eb2abcd9a6d41db5231fcd80fac1d452bee 192.168.1.100:7002 slots:[5461-10922] (5462 slots) master 1 additional replica(s) M: 493083f2733bc181295f5b9a9fa9bc6fdf821958 192.168.1.100:7003 slots:[10923-16383] (5461 slots) master 1 additional replica(s) S: b60ef6cbea0ae06566d17db4a1b4452e56543419 192.168.1.100:7004 slots: (0 slots) slave replicates 241d6eb2abcd9a6d41db5231fcd80fac1d452bee S: 259de2d6be917e64cdc01604521da45cc1f8d842 192.168.1.100:7006 slots: (0 slots) slave replicates 7237efa105ff4246c02da08c0e65c18246755f2f S: b48e546e963f694eac91d49b285040bb2bec5513 192.168.1.100:7005 slots: (0 slots) slave replicates 493083f2733bc181295f5b9a9fa9bc6fdf821958 [OK] All nodes agree about slots configuration. &gt;&gt;&gt; Check for open slots... &gt;&gt;&gt; Check slots coverage... [OK] All 16384 slots covered. è‡³æ­¤ï¼ŒåŸºäºdockeréƒ¨ç½²çš„redis-clusteré›†ç¾¤å°±å·²ç»å®Œæˆ","categories":[{"name":"Server","slug":"Server","permalink":"https://mrjerryli.github.io/categories/Server/"},{"name":"Docker","slug":"Server/Docker","permalink":"https://mrjerryli.github.io/categories/Server/Docker/"}],"tags":[{"name":"centos","slug":"centos","permalink":"https://mrjerryli.github.io/tags/centos/"}],"keywords":[{"name":"Server","slug":"Server","permalink":"https://mrjerryli.github.io/categories/Server/"},{"name":"Docker","slug":"Server/Docker","permalink":"https://mrjerryli.github.io/categories/Server/Docker/"}]},{"title":"DockerComposeæ­zookeeperé›†ç¾¤","slug":"å®¹å™¨åŒ–éƒ¨ç½²zookeeper","date":"2020-05-17T18:24:08.000Z","updated":"2020-05-17T19:02:29.507Z","comments":true,"path":"post/7b97a5e1.html","link":"","permalink":"https://mrjerryli.github.io/post/7b97a5e1.html","excerpt":"","text":"å‡†å¤‡zookeeperé•œåƒ è¿™é‡Œä½¿ç”¨å®˜æ–¹æä¾›çš„é•œåƒï¼Œç‰ˆæœ¬ä¸º3.4.11 docker-composeåˆ†å¸ƒå¼ç®¡ç†ç»„ä»¶ï¼Œå…·ä½“å®‰è£…ä»¥åŠä½¿ç”¨æ–¹æ³•è§githubé¡¹ç›® å‡†å¤‡docker-compose.ymlæ–‡ä»¶ è¿™é‡Œè¦æ³¨æ„ä¸‹ymlè¯­æ³•ï¼Œkeyå†’å·åé¢æœ‰ç©ºæ ¼ è¿™é‡Œé‡‡ç”¨å®˜æ–¹é•œåƒæä¾›é»˜è®¤é…ç½®ï¼Œå¯æ ¹æ®docker-composeé…ç½®è¯´æ˜åšè°ƒæ•´ version: &#39;3.1&#39; services: zoo1: image: zookeeper:3.4.11 restart: always hostname: zoo1 container_name: zookeeper_1 #domainname: ports: - 2181:2181 volumes: - &#x2F;usr&#x2F;local&#x2F;docker_app&#x2F;zookeeper&#x2F;zoo1&#x2F;data:&#x2F;data - &#x2F;usr&#x2F;local&#x2F;docker_app&#x2F;zookeeper&#x2F;zoo1&#x2F;datalog:&#x2F;datalog environment: ZOO_MY_ID: 1 ZOO_SERVERS: server.1&#x3D;zoo1:2888:3888 server.2&#x3D;zoo2:2888:3888 server.3&#x3D;zoo3:2888:3888 zoo2: image: zookeeper:3.4.11 restart: always hostname: zoo2 container_name: zookeeper_2 ports: - 2182:2181 volumes: - &#x2F;usr&#x2F;local&#x2F;docker_app&#x2F;zookeeper&#x2F;zoo2&#x2F;data:&#x2F;data - &#x2F;usr&#x2F;local&#x2F;docker_app&#x2F;zookeeper&#x2F;zoo2&#x2F;datalog:&#x2F;datalog environment: ZOO_MY_ID: 2 ZOO_SERVERS: server.1&#x3D;zoo1:2888:3888 server.2&#x3D;zoo2:2888:3888 server.3&#x3D;zoo3:2888:3888 zoo3: image: zookeeper:3.4.11 restart: always hostname: zoo3 container_name: zookeeper_3 ports: - 2183:2181 volumes: - &#x2F;usr&#x2F;local&#x2F;docker_app&#x2F;zookeeper&#x2F;zoo3&#x2F;data:&#x2F;data - &#x2F;usr&#x2F;local&#x2F;docker_app&#x2F;zookeeper&#x2F;zoo3&#x2F;datalog:&#x2F;datalog environment: ZOO_MY_ID: 3 ZOO_SERVERS: server.1&#x3D;zoo1:2888:3888 server.2&#x3D;zoo2:2888:3888 server.3&#x3D;zoo3:2888:3888 docker-compseå‘½ä»¤æä¾›äº†ä¸€ç³»åˆ—å­å‘½ä»¤ Define and run multi-container applications with Docker. Usage: docker-compose [-f &lt;arg&gt;...] [options] [COMMAND] [ARGS...] docker-compose -h|--help Options: -f, --file FILE Specify an alternate compose file (default: docker-compose.yml) -p, --project-name NAME Specify an alternate project name (default: directory name) --verbose Show more output --no-ansi Do not print ANSI control characters -v, --version Print version and exit -H, --host HOST Daemon socket to connect to --tls Use TLS; implied by --tlsverify --tlscacert CA_PATH Trust certs signed only by this CA --tlscert CLIENT_CERT_PATH Path to TLS certificate file --tlskey TLS_KEY_PATH Path to TLS key file --tlsverify Use TLS and verify the remote --skip-hostname-check Don't check the daemon's hostname against the name specified in the client certificate (for example if your docker host is an IP address) --project-directory PATH Specify an alternate working directory (default: the path of the Compose file) Commands: build Build or rebuild services bundle Generate a Docker bundle from the Compose file config Validate and view the Compose file create Create services down Stop and remove containers, networks, images, and volumes events Receive real time events from containers exec Execute a command in a running container help Get help on a command images List images kill Kill containers logs View output from containers pause Pause services port Print the public port for a port binding ps List containers pull Pull service images push Push service images restart Restart services rm Remove stopped containers run Run a one-off command scale Set number of containers for a service start Start services stop Stop services top Display the running processes unpause Unpause services up Create and start containers version Show the Docker-Compose version information æ ¡éªŒæŒ‡å®šé…ç½®æ–‡ä»¶æ­£ç¡®æ€§ï¼Œé»˜è®¤é…ç½®æ–‡ä»¶åç§°docker-compose.ymlæˆ–docker-compose.ymlï¼Œæˆ‘è¿™é‡Œä½¿ç”¨è‡ªå®šä¹‰åç§°zookeeper-compose.yml æ³¨æ„ï¼šå¦‚è‹¥éœ€æŒ‡å®šé…ç½®æ–‡ä»¶ï¼Œå¿…é¡»åœ¨docker-composeåé¢æŒ‡å®šï¼Œä¸èƒ½åœ¨configç­‰å­å‘½ä»¤åé¢æŒ‡å®šï¼Œå¦åˆ™æ— æ•ˆï¼›å¦‚æœä½ ä½¿ç”¨é»˜è®¤é…ç½®æ–‡ä»¶åç§°ï¼Œä¸éœ€è¦æ˜¾å¼æŒ‡å®š-f docker-compose.yml // æŸ¥çœ‹configå‘½ä»¤å‚æ•° $ docker-compose -f zookeeper-compose.yml config --help // æ ¡éªŒé…ç½®æ–‡ä»¶ï¼Œä¸æ‰“å° $ docker-compose -f zookeeper-compose.yml config -q å¯åŠ¨zookeeperé›†ç¾¤// -d åå°å¯åŠ¨ $ docker-compose -f zookeeper-compose.yml up -d æŸ¥çœ‹å®¹å™¨å¯åŠ¨æƒ…å†µ$ docker-compose -f zookeeper-compose.yml ps Name Command State Ports ------------------------------------------------------------------------------------------------- zookeeper_1 /docker-entrypoint.sh zkSe ... Up 0.0.0.0:2181-&gt;2181/tcp, 2888/tcp, 3888/tcp zookeeper_2 /docker-entrypoint.sh zkSe ... Up 0.0.0.0:2182-&gt;2181/tcp, 2888/tcp, 3888/tcp zookeeper_3 /docker-entrypoint.sh zkSe ... Up 0.0.0.0:2183-&gt;2181/tcp, 2888/tcp, 3888/tcp æŸ¥çœ‹zookeeperé›†ç¾¤çŠ¶æ€ zoo1 $ docker exec -it zookeeper_1 /bin/sh /zookeeper-3.4.11 # zkServer.sh status ZooKeeper JMX enabled by default Using config: /conf/zoo.cfg Mode: follower // è¿™æ˜¯ä¸ªfollower zoo2 $ docker exec -it zookeeper_2 /bin/sh /zookeeper-3.4.11 # zkServer.sh status ZooKeeper JMX enabled by default Using config: /conf/zoo.cfg Mode: leader // è¿™æ˜¯ä¸ªleader zoo3 $ docker exec -it zookeeper_3 /bin/sh /zookeeper-3.4.11 # zkServer.sh status ZooKeeper JMX enabled by default Using config: /conf/zoo.cfg Mode: follower // è¿™ä¹Ÿæ˜¯ä¸ªfollowerå“¦ ä¸‰ä¸ªzookeeperæœåŠ¡éƒ½æ­£å¸¸å¯åŠ¨äº†","categories":[{"name":"Server","slug":"Server","permalink":"https://mrjerryli.github.io/categories/Server/"},{"name":"Docker","slug":"Server/Docker","permalink":"https://mrjerryli.github.io/categories/Server/Docker/"}],"tags":[{"name":"centos","slug":"centos","permalink":"https://mrjerryli.github.io/tags/centos/"}],"keywords":[{"name":"Server","slug":"Server","permalink":"https://mrjerryli.github.io/categories/Server/"},{"name":"Docker","slug":"Server/Docker","permalink":"https://mrjerryli.github.io/categories/Server/Docker/"}]},{"title":"docker-composeåœ¨çº¿å‡çº§","slug":"docker-composeåœ¨çº¿å‡çº§","date":"2020-05-17T04:11:25.000Z","updated":"2020-05-17T04:20:31.071Z","comments":true,"path":"post/b82f2049.html","link":"","permalink":"https://mrjerryli.github.io/post/b82f2049.html","excerpt":"","text":"docker-composeåœ¨çº¿å‡çº§è¿™ä¸ªæ¯”è¾ƒç®€å•ï¼Œå°±ä¸‰è¡Œå‘½ä»¤ã€‚ è·å–æœ€æ–°ç‰ˆæœ¬curl -L \"https://github.com/docker/compose/releases/download/1.25.5/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose æ³¨æ„ï¼š å…¶ä¸­1.23.2æ˜¯å¯ä»¥æ›´æ¢ä¸ºæœ€æ–°çš„ç‰ˆæœ¬å· æˆæƒ chmod +x /usr/local/bin/docker-compose æŸ¥çœ‹ç‰ˆæœ¬ docker-compose --version è¿™æ ·å°±åœ¨çº¿å‡çº§å®Œæˆäº†ï¼Œæ¯”è¾ƒç®€å•ã€‚","categories":[{"name":"Server","slug":"Server","permalink":"https://mrjerryli.github.io/categories/Server/"},{"name":"Docker","slug":"Server/Docker","permalink":"https://mrjerryli.github.io/categories/Server/Docker/"}],"tags":[{"name":"centos","slug":"centos","permalink":"https://mrjerryli.github.io/tags/centos/"}],"keywords":[{"name":"Server","slug":"Server","permalink":"https://mrjerryli.github.io/categories/Server/"},{"name":"Docker","slug":"Server/Docker","permalink":"https://mrjerryli.github.io/categories/Server/Docker/"}]},{"title":"é˜¿é‡Œäº‘é…ç½®Letâ€™s Encryptè¯ä¹¦","slug":"é˜¿é‡Œäº‘é…ç½®Letâ€™sEncryptè¯ä¹¦","date":"2020-05-16T20:06:25.000Z","updated":"2020-05-16T21:04:23.861Z","comments":true,"path":"post/7bd4d456.html","link":"","permalink":"https://mrjerryli.github.io/post/7bd4d456.html","excerpt":"","text":"Letâ€™s Encryptè¯ä¹¦ç”³è¯·ã€é˜¿é‡Œäº‘é…ç½®Letâ€™s Encryptè¯ä¹¦ä¸€ã€è¯ä¹¦ç”³è¯·ç”³è¯·å…¥å£ï¼šhttps://letsencrypt.osfipin.com/ç”³è¯·æˆåŠŸï¼Œå¦‚ä¸‹ï¼š ç‚¹å‡»æŸ¥æŸ¥ï¼Œå¯è¿›è¡Œè¯ä¹¦çš„ä¸‹è½½ è§£å‹åå¾—åˆ°å…­ä¸ªæ–‡ä»¶ å‹ç¼©åŒ…æ–‡ä»¶è¯´æ˜ private.pem å¯†é’¥ï¼Œå¯æ›´æ”¹åç¼€ä¸ºkey fullchain.crt å®Œæ•´è¯ä¹¦ï¼Œå¯æ›´æ”¹åç¼€ä¸ºpem certificate.pfx IISå’ŒTomcatä½¿ç”¨ï¼Œç§˜é’¥åœ¨detail.txtä¸­ certificate.crt åŸŸåè¯ä¹¦ï¼Œä¸€èˆ¬ä¸ç”¨ äºŒã€è¯ä¹¦å®‰è£…ç™»å½•é˜¿é‡Œäº‘æ§åˆ¶å°ï¼Œæ‰“å¼€SSLè¯ä¹¦åˆ—è¡¨ ç‚¹å‡»ä¸Šä¼ è¯ä¹¦ï¼Œå°†è¯ä¹¦æ–‡ä»¶åŠç§é’¥è¿›è¡Œä¸Šä¼  ä¸Šä¼ å®Œæˆåï¼Œç»“æœå¦‚ä¸‹å›¾ï¼Œåœ¨å·²ç­¾å‘ä¸­å¯æŸ¥è¯¢çš„åˆ° é˜¿é‡Œäº‘ECSæœåŠ¡å™¨æ‰“å¼€443å®‰å…¨ç»„è®¿é—®è§„åˆ™ SSHè¿›å…¥centosæœåŠ¡å™¨ï¼Œé…ç½®NGINXå…³äº HTTPS é…ç½®ï¼Œè„šæœ¬å¦‚ä¸‹ï¼š åœ¨NGINX é…ç½®ç›®å½•confä¸‹åˆ›å»ºæ–‡ä»¶å¤¹cert mkdir cert ä¸Šä¼ ç”³è¯·å…è´¹åŸŸåçš„è¯ä¹¦åŠç§˜é’¥æ–‡ä»¶ï¼Œå³fullchain.crt ä¸ cert/private.pem ç¼–è¾‘nginx.confæ–‡ä»¶ # HTTPS server server &#123; listen 443 ssl http2; server_name ä½ çš„åŸŸå; ssl_certificate cert/fullchain.crt; ssl_certificate_key cert/private.pem; ssl_protocols TLSv1.1 TLSv1.2; ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE; ssl_prefer_server_ciphers on; ssl_session_cache shared:SSL:10m; ssl_session_timeout 10m; location / &#123; root html; index index.html index.htm; &#125; &#125; æ£€æŸ¥NGINXé…ç½®æ–‡ä»¶æ˜¯å¦ç¼–è¾‘æ­£ç¡®ï¼Œé‡å¯NGINX â–¶ ./nginx -t nginx: the configuration file /opt/nginx/conf/nginx.conf syntax is ok nginx: configuration file /opt/nginx/conf/nginx.conf test is successful â–¶ ./nginx -s reload centoså¼€æ”¾443ç«¯å£ï¼Œé‡å¯é˜²ç«å¢™ â–¶ firewall-cmd --add-port=443/tcp --permanent â–¶ firewall-cmd --reload åˆ°è¿™ï¼Œå®‰å¿ƒçš„æ”¾ä½ çš„HTTPSçš„ç½‘ç«™æŠŠï¼Œå·²ç»å¤§åŠŸå‘Šæˆã€‚ æ³¨æ„ï¼š åœ¨NGINXé…ç½®httpsæ—¶ï¼Œå¯èƒ½ä¼šæŠ¥é”™æ‰¾ä¸åˆ° ssl,åŸå› æ˜¯åœ¨å®‰è£…NGINXæ—¶ï¼Œæ²¡æœ‰å°†sslæ¨¡å—è¿›è¡Œå®‰è£…ï¼Œè¯¥æ¨¡å—ä¾èµ–äº openssl openssl-develï¼Œå®‰è£…è„šæœ¬å¦‚ä¸‹,éšåä»æ–°ç¼–è¯‘å®‰è£…NGINXå°±å¯ä»¥äº†ã€‚ yum -y install openssl openssl-devel ç¼ºç‚¹å°±æ˜¯è¯ä¹¦åªèƒ½ç»´æŒä¸‰ä¸ªæœˆï¼Œä¸æ˜¯é•¿ä¹…ï¼Œè§£å†³æ–¹æ¡ˆä¸ºä½¿ç”¨è„šæœ¬å®šæ—¶åˆ·æ–°æ›´æ–°è¯ä¹¦ï¼Œä½†æ˜¯é˜¿é‡Œäº‘è¿˜æ˜¯éœ€è¦æ‰‹å·¥è¿›è¡Œé…ç½®ã€‚","categories":[{"name":"Server","slug":"Server","permalink":"https://mrjerryli.github.io/categories/Server/"}],"tags":[{"name":"centos","slug":"centos","permalink":"https://mrjerryli.github.io/tags/centos/"}],"keywords":[{"name":"Server","slug":"Server","permalink":"https://mrjerryli.github.io/categories/Server/"}]},{"title":"MACä½¿ç”¨homeBrewå®‰è£…Redis","slug":"MACä½¿ç”¨homeBrewå®‰è£…Redis","date":"2019-10-21T16:55:09.000Z","updated":"2019-10-21T16:58:13.026Z","comments":true,"path":"post/63201c18.html","link":"","permalink":"https://mrjerryli.github.io/post/63201c18.html","excerpt":"","text":"MACä½¿ç”¨homeBrewå®‰è£…Redisä¸€èˆ¬ä¹°äº†macbookç¬¬ä¸€ä»¶äº‹å°±æ˜¯æŠŠhomeBrewå’Œiterm2è£…ä¸Š,å®ƒä»¬ä¿©çš„ç»„åˆå¯ä»¥å®ç°ç»å¤§å¤šæ•°çš„è½¯ä»¶å®‰è£…ã€‚ç½‘ä¸Šæœ‰å¾ˆå¤šæ•™ç¨‹å®‰è£…å®ƒä»¬çš„ï¼Œå…³äºhomeBrewçš„æ“ä½œå‘½ä»¤å¦‚ä¸‹: brew search ** //æŸ¥æ‰¾æŸä¸ªè½¯ä»¶åŒ… brew list //åˆ—å‡ºå·²ç»å®‰è£…çš„è½¯ä»¶çš„åŒ… brew install ** //å®‰è£…æŸä¸ªè½¯ä»¶åŒ…,é»˜è®¤å®‰è£…çš„æ˜¯ç¨³å®šç‰ˆæœ¬ brew uninstall **//å¸è½½æŸä¸ªè½¯ä»¶çš„åŒ… brew upgrade ** //æ›´æ–°æŸä¸ªè½¯ä»¶åŒ… brew info ** //æŸ¥çœ‹æŒ‡å®šè½¯ä»¶åŒ…çš„è¯´æ˜ brew cache clean //æ¸…ç†ç¼“å­˜ ç°åœ¨æˆ‘ä»¬å°è¯•åœ¨macä¸Šé€šè¿‡homeBrewå®‰è£…redis brew search redis //å‡ºç°å¦‚ä¸‹ ==&gt; Searching local taps... hiredis redis redis-leveldb redis@2.8 redis@3.2 ==&gt; Searching taps on GitHub... homebrew/cask/redis-app ==&gt; Searching blacklisted, migrated and deleted formulae... å®‰è£…redis3.2ç‰ˆæœ¬ brew install redis@3.2 å®‰è£…å®Œæˆæç¤ºå¦‚ä¸‹ //æŠŠredisçš„ç¯å¢ƒå˜é‡é…ç½®åˆ°.zshrcä¸­ If you need to have redis@3.2 first in your PATH run: echo 'export PATH=\"/usr/local/opt/redis@3.2/bin:$PATH\"' &gt;&gt; ~/.zshrc To have launchd start redis@3.2 now and restart at login: //ä½¿ç”¨launchctl brewå¯åŠ¨ brew services start redis@3.2 ### ä½¿ç”¨é…ç½®æ–‡ä»¶å¯åŠ¨ Or, if you don't want/need a background service you can just run: redis-server /usr/local/etc/redis.conf ==&gt; Summary ğŸº /usr/local/Cellar/redis@3.2/3.2.12: 13 files, 1.7MB /usr/local/etc ä¸‹ä¿®æ”¹redis.configæ‰¾åˆ°daemonize noæ”¹æˆyes ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼å¯åŠ¨é…ç½®ç¯å¢ƒå˜é‡echo â€˜export PATH=â€/usr/local/opt/redis@3.2/bin:$PATHâ€â€˜ &gt;&gt; ~/.zshrc å¯åŠ¨:brew services start redis@3.2æˆ–è€…ä½¿ç”¨redis-server /usr/local/etc/redis.confå¯åŠ¨æŸ¥çœ‹è¿›ç¨‹ps axu | grep redis isole 84721 0.0 0.0 4267768 900 s000 S+ 10:08ä¸Šåˆ 0:00.00 grep redis isole 84501 0.0 0.0 4309180 1568 ?? Ss 10:06ä¸Šåˆ 0:00.07 redis-server 127.0.0.1:6379 è¿æ¥å®¢æˆ·ç«¯:redis-cli -h 127.0.0.1 -p 6379å¦‚ä¸‹:127.0.0.1:6379&gt; get(â€œ123â€) å…³é—­redis-cli shutdownæ€æ­»sudo pkill redis-server å…³äºredis.confé…ç½®æ–‡ä»¶çš„è¯´æ˜ redisé»˜è®¤æ˜¯å‰å°å¯åŠ¨,ä¸æ˜¯ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿›è¡Œ:daemonize no,æŠŠè¿™é‡Œä¿®æ”¹æˆyes,å°±å¯ä»¥è®©redisä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼å¯åŠ¨ã€‚ å½“redisä½¿ç”¨å®ˆæŠ¤è¿›ç¨‹æ–¹å¼è¿è¡Œ,ä¼šé»˜è®¤æŠŠpidå†™å…¥/var/run/reids.pidæ–‡ä»¶ä¸­,å¯ä»¥é€šè¿‡pidfile /var/run/redis.pidè¿›è¡ŒæŒ‡å®šã€‚ ç«¯å£å·æŒ‡å®š,è¿™ä¸ªä¸ç”¨å¤šè¯´äº†,é»˜è®¤æ˜¯6379,å¯ä»¥æ ¹æ®éœ€è¦è‡ªå·±ä¿®æ”¹ã€‚ å®¢æˆ·ç«¯å¦‚æœä¸€ç›´è¿æ¥ç€ä¸é‡Šæ”¾çš„è¯ä¼šè‡ªåŠ¨å…³é—­è¿æ¥,è¿™æ˜¯é€šè¿‡timeout 100æ¥è®¾å®šçš„,å¦‚æœè®¾ç½®ä¸º0è¡¨ç¤ºä¸ä¼šè‡ªåŠ¨å…³é—­ã€‚ è®¾ç½®redisæ•°æ®åº“çš„æ•°é‡, databases 16 é»˜è®¤æ˜¯16 æ—¢ç„¶redisæ˜¯ä¸€ä¸ªæ•°æ®åº“,å°±ä»£è¡¨å¦‚æœéœ€è¦è¿æ¥çš„è¯å¯èƒ½éœ€è¦é…ç½®ä¸€ä¸ªå¯†ç ,é»˜è®¤æ˜¯ä¸éœ€è¦å¯†ç çš„ã€‚requirepass foobared,å®¢æˆ·ç«¯åœ¨é“¾æ¥æ—¶éœ€è¦é€šè¿‡AUTHå‘½ä»¤æä¾›å¯†ç ã€‚ç­‰ç­‰è¿˜æœ‰å¾ˆå¤šï¼Œè¿™é‡Œä»…ä»…ä»‹ç»äº†ä¸€ç‚¹ç‚¹çš„å‘½ä»¤ï¼Œç›´æ¥ä¿®æ”¹redis.confæ˜¯ä¸€ä¸ªæ–¹æ³•,ä½†æ˜¯è¿˜æœ‰å¦å¤–ä¸€ä¸ªæ–¹æ³•å°±æ˜¯é€šè¿‡å‘½ä»¤è¡Œå»ä¿®æ”¹ã€‚redis 127.0.0.1:6379&gt; CONFIG GET CONFIG_SETTING_NAME æŸ¥çœ‹æŸä¸ªé…ç½®æ¯”å¦‚ : æˆ‘ä»¬è¦æŸ¥çœ‹daemonize ç›´æ¥è¾“å…¥redis 127.0.0.1:6379&gt; CONFIG GET daemonizeä¿®æ”¹çš„è¯ç›´æ¥:redis 127.0.0.1:6379&gt;CONFIG SET daemonize yesè¿™æ ·å°±å¯ä»¥äº†ã€‚","categories":[{"name":"Server","slug":"Server","permalink":"https://mrjerryli.github.io/categories/Server/"}],"tags":[{"name":"Mac","slug":"Mac","permalink":"https://mrjerryli.github.io/tags/Mac/"}],"keywords":[{"name":"Server","slug":"Server","permalink":"https://mrjerryli.github.io/categories/Server/"}]},{"title":"springboot-thymeleafåŠ¨æ€æ¨¡æ¿ç”Ÿæˆ","slug":"springboot-thymeleafåŠ¨æ€æ¨¡æ¿ç”Ÿæˆ","date":"2019-10-12T12:13:18.000Z","updated":"2019-10-21T16:56:48.420Z","comments":true,"path":"post/457323eb.html","link":"","permalink":"https://mrjerryli.github.io/post/457323eb.html","excerpt":"","text":"springboot-thymeleafåŠ¨æ€æ¨¡æ¿ç”Ÿæˆ thymeleafåŠ¨æ€æ¨¡æ¿ï¼Œæ¡ˆä¾‹ Map data = new HashMap(); data.put(\"name\", \"jerry\"); data.put(\"email\", email); data.put(\"url\", \"https://www.lijiating.online/\"); data.put(\"secondairePath\", \"myblog\"); data.put(\"requestId\", \"\"); SpringTemplateEngine springTemplateEngine = new SpringTemplateEngine(); StringTemplateResolver stringTemplateResolver = new StringTemplateResolver(); stringTemplateResolver.setCacheable(true); stringTemplateResolver.setTemplateMode(TemplateMode.HTML); springTemplateEngine.setTemplateResolver(stringTemplateResolver) Context context = new Context(); context.setVariables(data); String content = \"&lt;span th:utext=\\\"$&#123;code&#125;\\\"&gt;&lt;/span&gt;\"; String result = springTemplateEngine.process(content, context); pomæ–‡ä»¶å¼•å…¥ï¼š &lt;dependency&gt; &lt;groupId&gt;org.thymeleaf&lt;/groupId&gt; &lt;artifactId&gt;thymeleaf&lt;/artifactId&gt; &lt;version&gt;3.0.9.RELEASE&lt;/version&gt; &lt;/dependency&gt; springbootå¯ç›´æ¥å¼•å…¥ï¼š &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt; &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;&#x2F;artifactId&gt; &lt;version&gt;2.0.4.RELEASE&lt;&#x2F;version&gt; &lt;&#x2F;dependency&gt;","categories":[{"name":"Server","slug":"Server","permalink":"https://mrjerryli.github.io/categories/Server/"}],"tags":[{"name":"springboot","slug":"springboot","permalink":"https://mrjerryli.github.io/tags/springboot/"}],"keywords":[{"name":"Server","slug":"Server","permalink":"https://mrjerryli.github.io/categories/Server/"}]},{"title":"macæ€æ­»ç«¯å£","slug":"macæ€æ­»ç«¯å£","date":"2019-09-19T11:33:06.000Z","updated":"2019-09-19T11:42:16.709Z","comments":true,"path":"post/87630688.html","link":"","permalink":"https://mrjerryli.github.io/post/87630688.html","excerpt":"","text":"Mac æŸ¥çœ‹ç«¯å£å ç”¨åŠæ€æ­»è¿›ç¨‹ æŸ¥çœ‹ç«¯å£å ç”¨æƒ…å†µ # jerry in ~ [14:04:53] C:1 $ lsof -i :18088 COMMAND PID USER FD TYPE DEVICE SIZE/OFF NODE NAME java 27191 lijiating 287u IPv6 0xcebad4dccbf6e8d1 0t0 TCP *:18088 (LISTEN) æ€æ­»å ç”¨ç«¯å£çš„è¿›ç¨‹ # jerry in ~ [14:05:08] $ kill -9 27191","categories":[{"name":"Server","slug":"Server","permalink":"https://mrjerryli.github.io/categories/Server/"}],"tags":[{"name":"linux","slug":"linux","permalink":"https://mrjerryli.github.io/tags/linux/"}],"keywords":[{"name":"Server","slug":"Server","permalink":"https://mrjerryli.github.io/categories/Server/"}]},{"title":"ZooKeeperå®‰è£…åŠé…ç½® for Mac","slug":"zookeeper","date":"2019-09-10T13:45:35.000Z","updated":"2019-09-10T14:21:30.996Z","comments":true,"path":"post/3ad834c9.html","link":"","permalink":"https://mrjerryli.github.io/post/3ad834c9.html","excerpt":"","text":"ZooKeeperå®‰è£…åŠé…ç½® for Mac å®‰è£… æŸ¥çœ‹brew info zookeeper $ brew info zookeeper zookeeper: stable 3.4.12 (bottled), HEAD Centralized server for distributed coordination of services https://zookeeper.apache.org/ å®‰è£…brew install zookeeper $ brew install zookeeper ==&gt; Downloading https://homebrew.bintray.com/bottles/zookeeper-3.4.12.high_sierr ###### ################################################################## 100.0% ==&gt; Pouring zookeeper-3.4.12.high_sierra.bottle.tar.gz ==&gt; Caveats To have launchd start zookeeper now and restart at login: brew services start zookeeper Or, if you don't want/need a background service you can just run: zkServer start å®‰è£…åï¼Œåœ¨/usr/local/etc/zookeeper/ ä¸­å¯æŸ¥çœ‹é…ç½® $ ls /usr/local/etc/zookeeper/ å®‰è£…åï¼Œåœ¨/usr/local/etc/zookeeper/ å·²ç»æœ‰äº†ç¼ºçœé…ç½® $ ls /usr/local/etc/zookeeper/ æŸ¥çœ‹é…ç½®æ–‡ä»¶ $ less -N /usr/local/etc/zookeeper/zoo.cfg é…ç½®æ–‡ä»¶å¦‚ä¸‹ # The number of milliseconds of each tick tickTime=2000 # The number of ticks that the initial # synchronization phase can take initLimit=10 # The number of ticks that can pass between # sending a request and getting an acknowledgement syncLimit=5 # the directory where the snapshot is stored. # do not use /tmp for storage, /tmp here is just # example sakes. dataDir=/usr/local/var/run/zookeeper/data # the port at which the clients will connect clientPort=2181 # the maximum number of client connections. # increase this if you need to handle more clients #maxClientCnxns=60 # # Be sure to read the maintenance section of the # administrator guide before turning on autopurge. # # http://zookeeper.apache.org/doc/current/zookeeperAdmin.html#sc_maintenance # # The number of snapshots to retain in dataDir #autopurge.snapRetainCount=3 # Purge task interval in hours # Set to \"0\" to disable auto purge feature #autopurge.purgeInterval=1 å¯åŠ¨æœåŠ¡ æ‰§è¡Œå‘½ä»¤zkServer $ zkServer ZooKeeper JMX enabled by default Using config: /usr/local/etc/zookeeper/zoo.cfg Usage: ./zkServer.sh &#123;start|start-foreground|stop|restart|status|upgrade|print-cmd&#125; $ zkServer status ZooKeeper JMX enabled by default Using config: /usr/local/etc/zookeeper/zoo.cfg Error contacting service. It is probably not running. $ zkServer start ZooKeeper JMX enabled by default Using config: /usr/local/etc/zookeeper/zoo.cfg Starting zookeeper ... STARTED æŸ¥çœ‹zookeeperè¿è¡ŒåŠçŠ¶æ€ å®‰è£…åï¼Œå¯ä»¥çœ‹åˆ°zookeeperæä¾›äº†zkCliç­‰å·¥å…·è¿›è¡Œ. $ zkServer status ZooKeeper JMX enabled by default Using config: /usr/local/etc/zookeeper/zoo.cfg Error contacting service. It is probably not running. 192:~ maerfeifei$ zkServer start ZooKeeper JMX enabled by default Using config: /usr/local/etc/zookeeper/zoo.cfg Starting zookeeper ... STARTED 192:~ maerfeifei$ zkCli Connecting to localhost:2181 Welcome to ZooKeeper! JLine support is enabled WATCHER:: WatchedEvent state:SyncConnected type:None path:null [zk: localhost:2181(CONNECTED) 0]","categories":[{"name":"Server","slug":"Server","permalink":"https://mrjerryli.github.io/categories/Server/"}],"tags":[{"name":"zookeeper","slug":"zookeeper","permalink":"https://mrjerryli.github.io/tags/zookeeper/"}],"keywords":[{"name":"Server","slug":"Server","permalink":"https://mrjerryli.github.io/categories/Server/"}]},{"title":"yarnåˆ‡æ¢é•œåƒæº","slug":"yarn","date":"2019-08-28T08:23:25.000Z","updated":"2019-08-28T08:32:36.881Z","comments":true,"path":"post/c965c636.html","link":"","permalink":"https://mrjerryli.github.io/post/c965c636.html","excerpt":"","text":"1ã€æŸ¥çœ‹ä¸€ä¸‹å½“å‰æº yarn config get registry 2ã€åˆ‡æ¢ä¸ºæ·˜å®æº yarn config set registry https://registry.npm.taobao.org 3ã€æˆ–è€…åˆ‡æ¢ä¸ºè‡ªå¸¦çš„ yarn config set registry https://registry.yarnpkg.com","categories":[{"name":"yarn","slug":"yarn","permalink":"https://mrjerryli.github.io/categories/yarn/"}],"tags":[{"name":"web","slug":"web","permalink":"https://mrjerryli.github.io/tags/web/"}],"keywords":[{"name":"yarn","slug":"yarn","permalink":"https://mrjerryli.github.io/categories/yarn/"}]},{"title":"centos","slug":"centos","date":"2019-08-04T23:32:01.000Z","updated":"2019-08-11T03:39:26.557Z","comments":true,"path":"post/cd183338.html","link":"","permalink":"https://mrjerryli.github.io/post/cd183338.html","excerpt":"","text":"CentOS 7 å¼€æ”¾3306ç«¯å£è®¿é—® CentOS 7.0é»˜è®¤ä½¿ç”¨çš„æ˜¯firewallä½œä¸ºé˜²ç«å¢™ï¼Œè¿™é‡Œæ”¹ä¸ºiptablesé˜²ç«å¢™ã€‚1ã€å…³é—­firewallï¼šsystemctl stop firewalld.servicesystemctl disable firewalld.servicesystemctl mask firewalld.service 2ã€å®‰è£…iptablesé˜²ç«å¢™yum install iptables-services -y 3.å¯åŠ¨è®¾ç½®é˜²ç«å¢™ systemctl enable iptablessystemctl start iptables4.æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€ systemctl status iptables 5ç¼–è¾‘é˜²ç«å¢™ï¼Œå¢åŠ ç«¯å£vi /etc/sysconfig/iptables #ç¼–è¾‘é˜²ç«å¢™é…ç½®æ–‡ä»¶-A INPUT -m state â€“state NEW -m tcp -p tcp â€“dport 22 -j ACCEPT-A INPUT -m state â€“state NEW -m tcp -p tcp â€“dport 80 -j ACCEPT-A INPUT -m state â€“state NEW -m tcp -p tcp â€“dport 3306 -j ACCEPT æˆ–è€… -A INPUT -p tcp -m state â€“state NEW -m tcp â€“dport 22 -j ACCEPT-A INPUT -p tcp -m state â€“state NEW -m tcp â€“dport 80 -j ACCEPT-A INPUT -p tcp -m state â€“state NEW -m tcp â€“dport 3306 -j ACCEPT :wq! #ä¿å­˜é€€å‡º 3.é‡å¯é…ç½®ï¼Œé‡å¯ç³»ç»Ÿsystemctl restart iptables.service #é‡å¯é˜²ç«å¢™ä½¿é…ç½®ç”Ÿæ•ˆsystemctl enable iptables.service #è®¾ç½®é˜²ç«å¢™å¼€æœºå¯åŠ¨","categories":[{"name":"Server","slug":"Server","permalink":"https://mrjerryli.github.io/categories/Server/"}],"tags":[{"name":"centos","slug":"centos","permalink":"https://mrjerryli.github.io/tags/centos/"}],"keywords":[{"name":"Server","slug":"Server","permalink":"https://mrjerryli.github.io/categories/Server/"}]},{"title":"protobuf","slug":"protobuf","date":"2019-08-03T20:53:47.000Z","updated":"2019-08-11T01:39:47.195Z","comments":true,"path":"post/99fac5be.html","link":"","permalink":"https://mrjerryli.github.io/post/99fac5be.html","excerpt":"","text":"ä»€ä¹ˆæ˜¯protobufå®˜æ–¹è§£é‡Šï¼šProtocol buffers are Googleâ€™s language-neutral, platform-neutral, extensible mechanism for serializing structured data â€“ think XML, but smaller, faster, and simpler. æ„æ€æ˜¯: Protocol buffersæ˜¯Googleçš„è¯­è¨€ä¸­ç«‹ï¼Œå¹³å°ä¸­ç«‹ï¼Œå¯æ‰©å±•çš„æœºåˆ¶ï¼Œç”¨äºåºåˆ—åŒ–ç»“æ„åŒ–æ•°æ® - ç±»ä¼¼XMLï¼Œä½†æ›´å°ï¼Œæ›´å¿«ï¼Œæ›´ç®€å•ã€‚ ä½¿ç”¨ Protobuf ä½ å¯ä»¥ç¼–å†™ä¸€æ¬¡ç»“æ„åŒ–æ•°æ®ä¸€æ¬¡ï¼Œç„¶åå¯ä»¥ä½¿ç”¨å„ç§è¯­è¨€å·¥å…·æ¥ç”Ÿæˆå¯¹åº”è¯­è¨€çš„æºä»£ç ç„¶åç®€å•çš„è¯»å–æˆ–è€…æ“ä½œæ•°æ®ã€‚ æŠ“é‡ç‚¹ï¼Œè¯­è¨€ä¸­ç«‹ï¼Œ å·¥å…·ï¼Œæºä»£ç  ä½¿ç”¨ä»ä¸Šé¢çš„ä»‹ç»ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨ä½¿ç”¨ Protobuf çš„ä½¿ç”¨éœ€è¦æœ‰ä¸€ä¸ªå¯¹åº”è¯­è¨€çš„å·¥å…·ï¼Œé€šè¿‡å·¥å…·ç”Ÿæˆå¯¹åº”çš„æºä»£ç ï¼Œç„¶ååœ¨æ“ä½œç›¸åº”ç»“æ„çš„æ•°æ®ã€‚ä¸‹é¢æˆ‘ä»¬ä¾æ¬¡çœ‹ä¸‹å…·ä½“æ˜¯å¦‚ä½•ä½¿ç”¨çš„ã€‚ é¦–å…ˆæˆ‘ä»¬è¿™é‡Œé‡‡ç”¨çš„æ˜¯ java è¯­è¨€ï¼Œæ‰€ä»¥è¦å…ˆå»ä¸‹è½½ Java å¯¹åº”çš„å·¥å…·é€šè¿‡é“¾æ¥https://github.com/protocolbuffers/protobuf/releases/tag/v3.8.0ä¸‹è½½ Java çš„å·¥å…·ï¼ŒmacOS å¯ä»¥ç›´æ¥ä½¿ç”¨brew install protobuf ç¼–å†™ .proto æ–‡ä»¶ï¼Œåœ¨ä½¿ç”¨ Protobuf å‰ï¼Œæˆ‘ä»¬è¦ç¼–å†™ç»“æ„åŒ–çš„æ•°æ®æ ¼å¼ï¼Œä¾‹å¦‚æˆ‘ä»¬è¿™é‡Œç¼–å†™ com-test-model-User.proto æ–‡ä»¶ &#x2F;&#x2F;æŒ‡å®šç‰ˆæœ¬ syntax &#x3D; &quot;proto2&quot;; &#x2F;&#x2F;å®šä¹‰åŒ…å package com.test.model; &#x2F;&#x2F;å®šä¹‰ç»“æ„æ•°æ® message User &#123; &#x2F;&#x2F;å¿…é€‰å­—æ®µ ç¬¬1ä¸ªå±æ€§ required string name &#x3D; 1; &#x2F;&#x2F;å¿…é€‰å­—æ®µ ç¬¬2ä¸ªå±æ€§ required int32 age &#x3D; 2; &#x2F;&#x2F;å¯é€‰å­—æ®µ ç¬¬3ä¸ªå±æ€§ optional string comment &#x3D; 3; &#125; ç¼–å†™å®Œäº†é‡‡ç”¨å‘½ä»¤protoc --java_out=. ./com-test-model-User.protoï¼Œå°±ä¼šåœ¨å½“å‰è·¯å¾„ä¸‹ç”Ÿæˆç›¸åº”çš„ä»£ç ç»“æ„ã€‚ ä½¿ç”¨æ¡ˆä¾‹public class Test &#123; public static void main(String[] args) throws IOException &#123; UserOuterClass.User.Builder userBuilder = UserOuterClass.User.newBuilder(); userBuilder.setName(\"å­æ‚ \"); userBuilder.setAge(18); // userBuilder.setComment(\"this is comment\"); System.out.println(\"\\n**********************åºåˆ—åŒ–*****************************\"); byte[] bytes = userBuilder.build().toByteArray(); System.out.println(\"bytes length is \" + bytes.length); for (int i = 0; i &lt; bytes.length; i++) &#123; System.out.print(bytes[i] + \" \"); &#125; System.out.println(\"\\n**********************ååºåˆ—åŒ–*****************************\"); UserOuterClass.User user = UserOuterClass.User.parseFrom(bytes); System.out.println(user.getName()); &#125; &#125; //è¿è¡Œç»“æœ **********************åºåˆ—åŒ–***************************** bytes length is 10 10 6 -27 -83 -112 -26 -126 -96 16 18 **********************ååºåˆ—åŒ–***************************** å­æ‚  Process finished with exit code 0 ç»“æœåˆ†æ å¯èƒ½åˆ°ç°åœ¨å¤§å®¶è¿˜æ²¡æœ‰å‘ç°ä»€ä¹ˆä¼˜ç§€çš„åœ°æ–¹ï¼Œé‚£ä¹ˆè®©æˆ‘è§£é‡Šä¸‹ã€‚ä»è¿è¡Œç»“æœæ¥çœ‹ï¼Œåºåˆ—åŒ–åçš„æ˜¯ä¸€ä¸²æ•°å­—ã€‚å¾ˆç®€çŸ­çš„ä¸€ä¸²æ•°å­—ã€‚æˆ‘ä»¬å¯ä»¥æƒ³ä¸€ä¸‹å¦‚æœè¿™é‡Œç”¨çš„ JSON æ ¼å¼çš„åºåˆ—åŒ–çš„è¯é‚£ä¹ˆç»“æœåº”è¯¥æ˜¯{&quot;name&quot;: &quot;å­æ‚ &quot;, &quot;age&quot;: 18}ï¼Œå¦‚æœæ˜¯ xml çš„è¯ï¼Œé‚£å°±ä¼šæ›´é•¿ï¼Œä»è¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥çœ‹å‡º protobuf çš„åºåˆ—åŒ–çš„æ•ˆæœæ˜¯å¤šä¹ˆçš„å¼ºå¤§ï¼Œæ•ˆç‡æ˜¯å¤šä¹ˆçš„é«˜ã€‚æˆ‘ä»¬çŸ¥é“åœ¨ç½‘ç»œä¼ è¾“çš„è¿‡ç¨‹ä¸­ï¼Œå‹ç¼©æ•ˆç‡è¶Šé«˜ä¼ è¾“æ•ˆç‡å°±è¶Šé«˜ã€‚ &lt;user&gt; &lt;name&gt;å­æ‚ &lt;/name&gt; &lt;age&gt;18&lt;/age&gt; &lt;/user&gt; protobuf ä¼˜ç¼ºç‚¹ æ›´åŠ ç®€å•ã€‚ æ•°æ®ä½“ç§¯å° 3- 10 å€ã€‚ æ›´å¿«çš„ååºåˆ—åŒ–é€Ÿåº¦ï¼Œæé«˜ 20 - 100 å€ã€‚ å¯ä»¥è‡ªåŠ¨åŒ–ç”Ÿæˆæ›´æ˜“äºç¼–ç æ–¹å¼ä½¿ç”¨çš„æ•°æ®è®¿é—®ç±»ã€‚ æ€»ç»“ ç®€å•ç»™å¤§å®¶ä»‹ç»äº† protobuf çš„ç®€å•ä½¿ç”¨ï¼Œæ›´å¤šçš„è¯¦ç»†ä½¿ç”¨ï¼Œä»¥åŠåº•å±‚å‹ç¼©åŸç†ï¼Œæ„Ÿå…´è¶£çš„æœ‹å‹å¯ä»¥è‡ªå·±çš„ç ”ç©¶ä¸€ä¸‹ã€‚ å¦å¤–è¯´ä¸ªé¢˜å¤–è¯ protocol buffers è¯ç”Ÿä¹‹åˆæ˜¯ä¸ºäº†è§£å†³æœåŠ¡å™¨ç«¯æ–°æ—§åè®®(é«˜ä½ç‰ˆæœ¬)å…¼å®¹æ€§é—®é¢˜ï¼Œåå­—ä¹Ÿå¾ˆä½“è´´ï¼Œâ€œåè®®ç¼“å†²åŒºâ€ã€‚åªä¸è¿‡åæœŸæ…¢æ…¢å‘å±•æˆç”¨äºä¼ è¾“æ•°æ®ã€‚ æœ‰æ—¶å€™å°±æ˜¯è¿™æ ·ï¼Œä¸€ä¸ªé¡¹ç›®æˆ–è€…è½¯ä»¶çš„æœ€ç»ˆå½¢æ€å¹¶ä¸æ˜¯å½“æ—¶å®šä¹‰çš„æ¨¡æ ·ï¼Œéšç€æ—¶é—´çš„æ¨ç§»äº§å“çš„æ–¹å‘ä»¥åŠå®šä½éƒ½ä¼šå‘ç”Ÿç¿»å¤©è¦†åœ°çš„å˜åŒ–ã€‚ é™„å±GitHubé¡¹ç›®demoåœ°å€","categories":[{"name":"Server","slug":"Server","permalink":"https://mrjerryli.github.io/categories/Server/"}],"tags":[{"name":"netty","slug":"netty","permalink":"https://mrjerryli.github.io/tags/netty/"},{"name":"protobuf","slug":"protobuf","permalink":"https://mrjerryli.github.io/tags/protobuf/"}],"keywords":[{"name":"Server","slug":"Server","permalink":"https://mrjerryli.github.io/categories/Server/"}]}]}